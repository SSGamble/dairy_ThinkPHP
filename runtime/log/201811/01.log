---------------------------------------------------------------
[ 2018-11-01T11:12:13+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/show/notelst.html
[ info ] qingrang.top/daily/admin/show/notelst.html [运行时间：0.098244s][吞吐率：10.18req/s] [内存消耗：2,132.04kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'show',
    2 => 'notelst',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Linux; Android 8.1.0; OE106 Build/OPM1.171019.026) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/show/notelst/groups/Algorithm.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540775434,1540791491,1540864157,1541042266; Hm_lpvt_1769181352e9adc950166aada465644e=1541042268',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Show->notelst[ /var/www/html/daily/application/admin/controller/Show.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/show/notelst.html [ array (
  0 => 'list_new',
  1 => 'groups',
  2 => 'groups0',
  3 => 'groups1',
  4 => 'groups2',
  5 => 'groupname',
  6 => 'content',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.001575s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.003262s ]
[ sql ] [ SQL ] SELECT `content` FROM `note` WHERE  (  id=32 ) LIMIT 1 [ RunTime:0.001326s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 LIMIT 1 [ RunTime:0.003330s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 ORDER BY id desc LIMIT 0,6 [ RunTime:0.000860s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001773s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `groups` <> 'Personal' [ RunTime:0.000549s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `groups` <> 'Personal'  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000572s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1  AND `groups` <> 'Personal' [ RunTime:0.000453s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000516s ]
---------------------------------------------------------------
[ 2018-11-01T11:13:34+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/show/notelst.html?page=2
[ info ] qingrang.top/daily/admin/show/notelst.html?page=2 [运行时间：0.077222s][吞吐率：12.95req/s] [内存消耗：2,107.02kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'show',
    2 => 'notelst',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Linux; Android 8.1.0; OE106 Build/OPM1.171019.026) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/show/notelst.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540775434,1540791491,1540864157,1541042266; Hm_lpvt_1769181352e9adc950166aada465644e=1541042275',
)
[ info ] [ PARAM ] array (
  'page' => '2',
)
[ info ] [ RUN ] app\admin\controller\Show->notelst[ /var/www/html/daily/application/admin/controller/Show.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/show/notelst.html [ array (
  0 => 'list_new',
  1 => 'groups',
  2 => 'groups0',
  3 => 'groups1',
  4 => 'groups2',
  5 => 'groupname',
  6 => 'content',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000644s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001721s ]
[ sql ] [ SQL ] SELECT `content` FROM `note` WHERE  (  id=32 ) LIMIT 1 [ RunTime:0.000636s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 LIMIT 1 [ RunTime:0.001819s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 ORDER BY id desc LIMIT 6,6 [ RunTime:0.000642s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001156s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `groups` <> 'Personal' [ RunTime:0.000340s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `groups` <> 'Personal'  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000519s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1  AND `groups` <> 'Personal' [ RunTime:0.000428s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000486s ]
---------------------------------------------------------------
[ 2018-11-01T11:13:37+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/show/notelst.html?page=3
[ info ] qingrang.top/daily/admin/show/notelst.html?page=3 [运行时间：0.078765s][吞吐率：12.70req/s] [内存消耗：2,186.59kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'show',
    2 => 'notelst',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Linux; Android 8.1.0; OE106 Build/OPM1.171019.026) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/show/notelst.html?page=2',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540775434,1540791491,1540864157,1541042266; Hm_lpvt_1769181352e9adc950166aada465644e=1541042355',
)
[ info ] [ PARAM ] array (
  'page' => '3',
)
[ info ] [ RUN ] app\admin\controller\Show->notelst[ /var/www/html/daily/application/admin/controller/Show.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/show/notelst.html [ array (
  0 => 'list_new',
  1 => 'groups',
  2 => 'groups0',
  3 => 'groups1',
  4 => 'groups2',
  5 => 'groupname',
  6 => 'content',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000629s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001440s ]
[ sql ] [ SQL ] SELECT `content` FROM `note` WHERE  (  id=32 ) LIMIT 1 [ RunTime:0.000587s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 LIMIT 1 [ RunTime:0.001765s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 ORDER BY id desc LIMIT 12,6 [ RunTime:0.000890s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001371s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `groups` <> 'Personal' [ RunTime:0.000332s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `groups` <> 'Personal'  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000471s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1  AND `groups` <> 'Personal' [ RunTime:0.000355s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000480s ]
---------------------------------------------------------------
[ 2018-11-01T11:13:40+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/show/notelst.html?page=4
[ info ] qingrang.top/daily/admin/show/notelst.html?page=4 [运行时间：0.081010s][吞吐率：12.34req/s] [内存消耗：2,134.63kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'show',
    2 => 'notelst',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Linux; Android 8.1.0; OE106 Build/OPM1.171019.026) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/show/notelst.html?page=3',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540775434,1540791491,1540864157,1541042266; Hm_lpvt_1769181352e9adc950166aada465644e=1541042358',
)
[ info ] [ PARAM ] array (
  'page' => '4',
)
[ info ] [ RUN ] app\admin\controller\Show->notelst[ /var/www/html/daily/application/admin/controller/Show.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/show/notelst.html [ array (
  0 => 'list_new',
  1 => 'groups',
  2 => 'groups0',
  3 => 'groups1',
  4 => 'groups2',
  5 => 'groupname',
  6 => 'content',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000699s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001533s ]
[ sql ] [ SQL ] SELECT `content` FROM `note` WHERE  (  id=32 ) LIMIT 1 [ RunTime:0.000663s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 LIMIT 1 [ RunTime:0.001277s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 ORDER BY id desc LIMIT 18,6 [ RunTime:0.000830s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001216s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `groups` <> 'Personal' [ RunTime:0.000450s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `groups` <> 'Personal'  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000624s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1  AND `groups` <> 'Personal' [ RunTime:0.001576s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000426s ]
---------------------------------------------------------------
[ 2018-11-01T11:13:43+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/show/notelst.html?page=5
[ info ] qingrang.top/daily/admin/show/notelst.html?page=5 [运行时间：0.090612s][吞吐率：11.04req/s] [内存消耗：2,113.73kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'show',
    2 => 'notelst',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Linux; Android 8.1.0; OE106 Build/OPM1.171019.026) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/show/notelst.html?page=4',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540775434,1540791491,1540864157,1541042266; Hm_lpvt_1769181352e9adc950166aada465644e=1541042361',
)
[ info ] [ PARAM ] array (
  'page' => '5',
)
[ info ] [ RUN ] app\admin\controller\Show->notelst[ /var/www/html/daily/application/admin/controller/Show.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/show/notelst.html [ array (
  0 => 'list_new',
  1 => 'groups',
  2 => 'groups0',
  3 => 'groups1',
  4 => 'groups2',
  5 => 'groupname',
  6 => 'content',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000572s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001669s ]
[ sql ] [ SQL ] SELECT `content` FROM `note` WHERE  (  id=32 ) LIMIT 1 [ RunTime:0.000591s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 LIMIT 1 [ RunTime:0.001898s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 ORDER BY id desc LIMIT 24,6 [ RunTime:0.001142s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001424s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `groups` <> 'Personal' [ RunTime:0.000465s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `groups` <> 'Personal'  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000557s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1  AND `groups` <> 'Personal' [ RunTime:0.000397s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000492s ]
---------------------------------------------------------------
[ 2018-11-01T11:13:46+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/show/notelst/groups/Basics.html
[ info ] qingrang.top/daily/admin/show/notelst/groups/Basics.html [运行时间：0.076996s][吞吐率：12.99req/s] [内存消耗：2,118.20kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'show',
    2 => 'notelst',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Linux; Android 8.1.0; OE106 Build/OPM1.171019.026) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/show/notelst.html?page=5',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540775434,1540791491,1540864157,1541042266; Hm_lpvt_1769181352e9adc950166aada465644e=1541042364',
)
[ info ] [ PARAM ] array (
  'groups' => 'Basics',
)
[ info ] [ RUN ] app\admin\controller\Show->notelst[ /var/www/html/daily/application/admin/controller/Show.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/show/notelst.html [ array (
  0 => 'list_new',
  1 => 'groups',
  2 => 'groups0',
  3 => 'groups1',
  4 => 'groups2',
  5 => 'groupname',
  6 => 'content',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000611s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001478s ]
[ sql ] [ SQL ] SELECT `content` FROM `note` WHERE  (  id=32 ) LIMIT 1 [ RunTime:0.000526s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 LIMIT 1 [ RunTime:0.001320s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 ORDER BY id desc LIMIT 0,6 [ RunTime:0.000607s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  ( `groups` <> 'Personal' AND `groups` = 'Basics' )  AND `publish` = 1 LIMIT 1 [ RunTime:0.001866s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  ( `groups` <> 'Personal' AND `groups` = 'Basics' )  AND `publish` = 1 ORDER BY id desc LIMIT 0,6 [ RunTime:0.000863s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001139s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `groups` <> 'Personal' [ RunTime:0.000401s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `groups` <> 'Personal'  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000396s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1  AND `groups` <> 'Personal' [ RunTime:0.000348s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000422s ]
---------------------------------------------------------------
[ 2018-11-01T11:13:48+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/show/shownote/id/230.html
[ info ] qingrang.top/daily/admin/show/shownote/id/230.html [运行时间：0.069357s][吞吐率：14.42req/s] [内存消耗：1,938.16kb] [文件加载：54]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'show',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'connection' => 'keep-alive',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Linux; Android 8.1.0; OE106 Build/OPM1.171019.026) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.84 Mobile Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/show/notelst/groups/Basics.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540775434,1540791491,1540864157,1541042266; Hm_lpvt_1769181352e9adc950166aada465644e=1541042367',
)
[ info ] [ PARAM ] array (
  'id' => '230',
)
[ info ] [ RUN ] app\admin\controller\Show->showNote[ /var/www/html/daily/application/admin/controller/Show.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/show/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000527s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001501s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 230 LIMIT 1 [ RunTime:0.000529s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000957s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000291s ]
---------------------------------------------------------------
[ 2018-11-01T15:51:52+08:00 ] 74.120.168.12 66.249.66.90 GET /daily/admin/note/editnote/id/
[ info ] qingrang.top/daily/admin/note/editnote/id/ [运行时间：0.053004s][吞吐率：18.87req/s] [内存消耗：1,427.05kb] [文件加载：49]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'editnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'connection' => 'keep-alive',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
  'from' => 'googlebot(at)googlebot.com',
  'user-agent' => 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)',
  'accept-encoding' => 'gzip,deflate,br',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ VIEW ] /var/www/html/daily/thinkphp/tpl/dispatch_jump.tpl [ array (
  0 => 'code',
  1 => 'msg',
  2 => 'data',
  3 => 'url',
  4 => 'wait',
) ]
[ info ] [ LOG ] INIT File
---------------------------------------------------------------
[ 2018-11-01T18:34:59+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/login/index.html
[ info ] qingrang.top/daily/admin/login/index.html [运行时间：0.041291s][吞吐率：24.22req/s] [内存消耗：1,339.90kb] [文件加载：47]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'login',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Login->index[ /var/www/html/daily/application/admin/controller/Login.php ]
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/login/index.html [ array (
) ]
[ info ] [ LOG ] INIT File
---------------------------------------------------------------
[ 2018-11-01T18:53:07+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/login/index.html
[ info ] qingrang.top/daily/admin/login/index.html [运行时间：0.042257s][吞吐率：23.66req/s] [内存消耗：1,339.90kb] [文件加载：47]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'login',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Login->index[ /var/www/html/daily/application/admin/controller/Login.php ]
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/login/index.html [ array (
) ]
[ info ] [ LOG ] INIT File
---------------------------------------------------------------
[ 2018-11-01T19:12:24+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.043781s][吞吐率：22.84req/s] [内存消耗：1,428.44kb] [文件加载：49]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ VIEW ] /var/www/html/daily/thinkphp/tpl/dispatch_jump.tpl [ array (
  0 => 'code',
  1 => 'msg',
  2 => 'data',
  3 => 'url',
  4 => 'wait',
) ]
[ info ] [ LOG ] INIT File
---------------------------------------------------------------
[ 2018-11-01T19:12:27+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/login/index.html
[ info ] qingrang.top/daily/admin/login/index.html [运行时间：0.052611s][吞吐率：19.01req/s] [内存消耗：1,340.78kb] [文件加载：47]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'login',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Login->index[ /var/www/html/daily/application/admin/controller/Login.php ]
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/login/index.html [ array (
) ]
[ info ] [ LOG ] INIT File
---------------------------------------------------------------
[ 2018-11-01T19:12:31+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/login/index.html
[ info ] qingrang.top/daily/admin/login/index.html [运行时间：0.056366s][吞吐率：17.74req/s] [内存消耗：1,922.37kb] [文件加载：54]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'login',
    2 => 'index',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '8',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/login/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'pwd' => 'shao',
)
[ info ] [ RUN ] app\admin\controller\Login->index[ /var/www/html/daily/application/admin/controller/Login.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.001397s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `admin` [ RunTime:0.002428s ]
[ sql ] [ SQL ] SELECT * FROM `admin` WHERE  `id` = 1 LIMIT 1 [ RunTime:0.000511s ]
---------------------------------------------------------------
[ 2018-11-01T19:12:31+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.079418s][吞吐率：12.59req/s] [内存消耗：2,191.49kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/login/index.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000712s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001593s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.003570s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000554s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.000978s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000375s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000543s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000877s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000347s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000419s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000342s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000397s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001241s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000264s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.001063s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.000717s ]
---------------------------------------------------------------
[ 2018-11-01T19:12:34+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/ashownote2.html
[ info ] qingrang.top/daily/admin/note/ashownote2.html [运行时间：0.056872s][吞吐率：17.58req/s] [内存消耗：2,160.81kb] [文件加载：52]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'ashownote2',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '19',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'origin' => 'http://qingrang.top',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'groupname' => 'Algorithm',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->aShowNote2[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000585s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001443s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` = 'Algorithm' ORDER BY date desc [ RunTime:0.001449s ]
---------------------------------------------------------------
[ 2018-11-01T19:12:39+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/ashownote2.html
[ info ] qingrang.top/daily/admin/note/ashownote2.html [运行时间：0.056059s][吞吐率：17.84req/s] [内存消耗：2,131.25kb] [文件加载：52]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'ashownote2',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '23',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'origin' => 'http://qingrang.top',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'groupname' => 'DesignPattern',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->aShowNote2[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000566s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001602s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` = 'DesignPattern' ORDER BY date desc [ RunTime:0.001550s ]
---------------------------------------------------------------
[ 2018-11-01T19:12:42+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/newedit.html
[ info ] qingrang.top/daily/admin/note/newedit.html [运行时间：0.071432s][吞吐率：14.00req/s] [内存消耗：2,020.98kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'newedit',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->newEdit[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/newedit.html [ array (
  0 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000924s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.002036s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.001198s ]
---------------------------------------------------------------
[ 2018-11-01T19:12:58+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/addnote.html
[ info ] qingrang.top/daily/admin/note/addnote.html [运行时间：0.064233s][吞吐率：15.57req/s] [内存消耗：1,976.41kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'addnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '356',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/newedit.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'groups' => 'DesignPattern',
  'content' => '# 代理模式
',
  'test-editormd-html-code' => '<h1 id="h1-u4EE3u7406u6A21u5F0F"><a name="代理模式" class="reference-link"></a><span class="header-link octicon octicon-link"></span>代理模式</h1>',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->addNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000736s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001994s ]
[ sql ] [ SQL ] SELECT `parent_id` FROM `groups` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.000464s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `id` = 2 LIMIT 1 [ RunTime:0.000394s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001476s ]
[ sql ] [ SQL ] INSERT INTO `note` (`title` , `content` , `groups` , `p_id` , `date`) VALUES ('代理模式\r' , '# 代理模式\r\n' , 'DesignPattern' , 2 , '2018-11-01') [ RunTime:0.000675s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.002180s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=2  WHERE  `groups` = 'DesignPattern' [ RunTime:0.000680s ]
---------------------------------------------------------------
[ 2018-11-01T19:12:59+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.071811s][吞吐率：13.93req/s] [内存消耗：2,191.19kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/newedit.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000450s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001496s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.001613s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000415s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.001222s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000357s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000491s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000994s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000282s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000396s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000326s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000405s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001260s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000244s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.001068s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.000670s ]
---------------------------------------------------------------
[ 2018-11-01T19:13:04+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/editnote/id/237.html
[ info ] qingrang.top/daily/admin/note/editnote/id/237.html [运行时间：0.052713s][吞吐率：18.97req/s] [内存消耗：2,027.88kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'editnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->editNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/editnote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000467s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001365s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000399s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000919s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000315s ]
---------------------------------------------------------------
[ 2018-11-01T19:55:11+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/savenote.html
[ info ] qingrang.top/daily/admin/note/savenote.html [运行时间：0.061582s][吞吐率：16.24req/s] [内存消耗：2,021.69kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'savenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '158',
  'accept' => 'text/plain, */*; q=0.01',
  'origin' => 'http://qingrang.top',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded; charset=UTF-8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'ogroup' => 'Default',
  'context' => '# 代理模式
## 静态代理
## 动态代理
',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->saveNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000586s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001500s ]
[ sql ] [ SQL ] UPDATE `note`  SET `title`='代理模式',`content`='# 代理模式\n## 静态代理\n## 动态代理\n',`groups`='Default',`p_id`=1  WHERE  `id` = 1 [ RunTime:0.000487s ]
---------------------------------------------------------------
[ 2018-11-01T20:15:17+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/savenote.html
[ info ] qingrang.top/daily/admin/note/savenote.html [运行时间：0.055447s][吞吐率：18.04req/s] [内存消耗：2,046.68kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'savenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '7522',
  'accept' => 'text/plain, */*; q=0.01',
  'origin' => 'http://qingrang.top',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded; charset=UTF-8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'ogroup' => 'Default',
  'context' => '# 代理模式
客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。

>以生活中的“代理律师”为例来理解“代理模式”

打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。

聘请代理律师时以下几点需要特别说明：
（1）当事人与代理律师是在为同一件事情努力。
（2）法院所有的具体事务都是通过代理律师完成。
（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。

对于代理模式，需要注意以下几点：
（1）**代理类和目标类要实现同一个接口**，即业务接口。
（2）**客户类对目标类的调用均是通过代理类完成的**。
（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。

**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**
## 静态代理
静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。

静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。

### Demo
>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD

目标接口：
```
/**
 * 目标接口
 */
public interface ISomeService {
	//目标方法
	String doFirst();
	void doSecond();
}
```
目标实现类:
```
/**
 * 目标实现类
 */
public class SomeServiceImpl implements ISomeService {
	@Override
	public String doFirst() {
		System.out.println("doFirst");
		return "abcd";
	}

	@Override
	public void doSecond() {
		System.out.println("doSecond");
	}
}
```
代理类:
```
/**
 * 代理类
 */
public class SomeServiceProxy implements ISomeService {

	//目标对象
	SomeServiceImpl target;

	public SomeServiceProxy(){
		super();
		//创建目标对象
		target = new SomeServiceImpl();

	}

	@Override
	public String doFirst() {
		//代理类调用目标方法
		String result = target.doFirst();
		//增强就发生在这里
		return result.toUpperCase();
	}

	@Override
	public void doSecond() {
		target.doSecond();
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//利用代理对象执行方法
		SomeServiceProxy someServiceProxy = new SomeServiceProxy();
		String result = someServiceProxy.doFirst();
		System.out.println("result = " + result );
		someServiceProxy.doSecond();
	}
}
```
---
doFirst
result = ABCD
doSecond

---

## 动态代理
',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->saveNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000633s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001552s ]
[ sql ] [ SQL ] UPDATE `note`  SET `title`='代理模式',`content`='# 代理模式\n客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。\n\n>以生活中的“代理律师”为例来理解“代理模式”\n\n打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。\n\n聘请代理律师时以下几点需要特别说明：\n（1）当事人与代理律师是在为同一件事情努力。\n（2）法院所有的具体事务都是通过代理律师完成。\n（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。\n\n对于代理模式，需要注意以下几点：\n（1）**代理类和目标类要实现同一个接口**，即业务接口。\n（2）**客户类对目标类的调用均是通过代理类完成的**。\n（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。\n\n**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**\n## 静态代理\n静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。\n\n静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。\n\n### Demo\n>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD\n\n目标接口：\n```\n/**\n * 目标接口\n */\npublic interface ISomeService {\n	//目标方法\n	String doFirst();\n	void doSecond();\n}\n```\n目标实现类:\n```\n/**\n * 目标实现类\n */\npublic class SomeServiceImpl implements ISomeService {\n	@Override\n	public String doFirst() {\n		System.out.println(\"doFirst\");\n		return \"abcd\";\n	}\n\n	@Override\n	public void doSecond() {\n		System.out.println(\"doSecond\");\n	}\n}\n```\n代理类:\n```\n/**\n * 代理类\n */\npublic class SomeServiceProxy implements ISomeService {\n\n	//目标对象\n	SomeServiceImpl target;\n\n	public SomeServiceProxy(){\n		super();\n		//创建目标对象\n		target = new SomeServiceImpl();\n\n	}\n\n	@Override\n	public String doFirst() {\n		//代理类调用目标方法\n		String result = target.doFirst();\n		//增强就发生在这里\n		return result.toUpperCase();\n	}\n\n	@Override\n	public void doSecond() {\n		target.doSecond();\n	}\n}\n```\n测试：\n```\npublic class MyTest {\n	public static void main(String[] args) {\n		//利用代理对象执行方法\n		SomeServiceProxy someServiceProxy = new SomeServiceProxy();\n		String result = someServiceProxy.doFirst();\n		System.out.println(\"result = \" + result );\n		someServiceProxy.doSecond();\n	}\n}\n```\n---\ndoFirst\nresult = ABCD\ndoSecond\n\n---\n\n## 动态代理\n',`groups`='Default',`p_id`=1  WHERE  `id` = 1 [ RunTime:0.000605s ]
---------------------------------------------------------------
[ 2018-11-01T20:15:18+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/savenote.html
[ info ] qingrang.top/daily/admin/note/savenote.html [运行时间：0.057634s][吞吐率：17.35req/s] [内存消耗：2,046.64kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'savenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '7522',
  'accept' => 'text/plain, */*; q=0.01',
  'origin' => 'http://qingrang.top',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded; charset=UTF-8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'ogroup' => 'Default',
  'context' => '# 代理模式
客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。

>以生活中的“代理律师”为例来理解“代理模式”

打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。

聘请代理律师时以下几点需要特别说明：
（1）当事人与代理律师是在为同一件事情努力。
（2）法院所有的具体事务都是通过代理律师完成。
（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。

对于代理模式，需要注意以下几点：
（1）**代理类和目标类要实现同一个接口**，即业务接口。
（2）**客户类对目标类的调用均是通过代理类完成的**。
（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。

**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**
## 静态代理
静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。

静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。

### Demo
>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD

目标接口：
```
/**
 * 目标接口
 */
public interface ISomeService {
	//目标方法
	String doFirst();
	void doSecond();
}
```
目标实现类:
```
/**
 * 目标实现类
 */
public class SomeServiceImpl implements ISomeService {
	@Override
	public String doFirst() {
		System.out.println("doFirst");
		return "abcd";
	}

	@Override
	public void doSecond() {
		System.out.println("doSecond");
	}
}
```
代理类:
```
/**
 * 代理类
 */
public class SomeServiceProxy implements ISomeService {

	//目标对象
	SomeServiceImpl target;

	public SomeServiceProxy(){
		super();
		//创建目标对象
		target = new SomeServiceImpl();

	}

	@Override
	public String doFirst() {
		//代理类调用目标方法
		String result = target.doFirst();
		//增强就发生在这里
		return result.toUpperCase();
	}

	@Override
	public void doSecond() {
		target.doSecond();
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//利用代理对象执行方法
		SomeServiceProxy someServiceProxy = new SomeServiceProxy();
		String result = someServiceProxy.doFirst();
		System.out.println("result = " + result );
		someServiceProxy.doSecond();
	}
}
```
---
doFirst
result = ABCD
doSecond

---

## 动态代理
',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->saveNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000438s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001222s ]
[ sql ] [ SQL ] UPDATE `note`  SET `title`='代理模式',`content`='# 代理模式\n客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。\n\n>以生活中的“代理律师”为例来理解“代理模式”\n\n打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。\n\n聘请代理律师时以下几点需要特别说明：\n（1）当事人与代理律师是在为同一件事情努力。\n（2）法院所有的具体事务都是通过代理律师完成。\n（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。\n\n对于代理模式，需要注意以下几点：\n（1）**代理类和目标类要实现同一个接口**，即业务接口。\n（2）**客户类对目标类的调用均是通过代理类完成的**。\n（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。\n\n**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**\n## 静态代理\n静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。\n\n静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。\n\n### Demo\n>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD\n\n目标接口：\n```\n/**\n * 目标接口\n */\npublic interface ISomeService {\n	//目标方法\n	String doFirst();\n	void doSecond();\n}\n```\n目标实现类:\n```\n/**\n * 目标实现类\n */\npublic class SomeServiceImpl implements ISomeService {\n	@Override\n	public String doFirst() {\n		System.out.println(\"doFirst\");\n		return \"abcd\";\n	}\n\n	@Override\n	public void doSecond() {\n		System.out.println(\"doSecond\");\n	}\n}\n```\n代理类:\n```\n/**\n * 代理类\n */\npublic class SomeServiceProxy implements ISomeService {\n\n	//目标对象\n	SomeServiceImpl target;\n\n	public SomeServiceProxy(){\n		super();\n		//创建目标对象\n		target = new SomeServiceImpl();\n\n	}\n\n	@Override\n	public String doFirst() {\n		//代理类调用目标方法\n		String result = target.doFirst();\n		//增强就发生在这里\n		return result.toUpperCase();\n	}\n\n	@Override\n	public void doSecond() {\n		target.doSecond();\n	}\n}\n```\n测试：\n```\npublic class MyTest {\n	public static void main(String[] args) {\n		//利用代理对象执行方法\n		SomeServiceProxy someServiceProxy = new SomeServiceProxy();\n		String result = someServiceProxy.doFirst();\n		System.out.println(\"result = \" + result );\n		someServiceProxy.doSecond();\n	}\n}\n```\n---\ndoFirst\nresult = ABCD\ndoSecond\n\n---\n\n## 动态代理\n',`groups`='Default',`p_id`=1  WHERE  `id` = 1 [ RunTime:0.000452s ]
---------------------------------------------------------------
[ 2018-11-01T20:15:26+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/updatenote/id/237.html
[ info ] qingrang.top/daily/admin/note/updatenote/id/237.html [运行时间：0.068978s][吞吐率：14.50req/s] [内存消耗：2,071.16kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'updatenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '7955',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'summary' => '',
  'content' => '# 代理模式
客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。

>以生活中的“代理律师”为例来理解“代理模式”

打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。

聘请代理律师时以下几点需要特别说明：
（1）当事人与代理律师是在为同一件事情努力。
（2）法院所有的具体事务都是通过代理律师完成。
（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。

对于代理模式，需要注意以下几点：
（1）**代理类和目标类要实现同一个接口**，即业务接口。
（2）**客户类对目标类的调用均是通过代理类完成的**。
（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。

**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**
## 静态代理
静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。

静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。

### Demo
>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD

目标接口：
```
/**
 * 目标接口
 */
public interface ISomeService {
	//目标方法
	String doFirst();
	void doSecond();
}
```
目标实现类:
```
/**
 * 目标实现类
 */
public class SomeServiceImpl implements ISomeService {
	@Override
	public String doFirst() {
		System.out.println("doFirst");
		return "abcd";
	}

	@Override
	public void doSecond() {
		System.out.println("doSecond");
	}
}
```
代理类:
```
/**
 * 代理类
 */
public class SomeServiceProxy implements ISomeService {

	//目标对象
	SomeServiceImpl target;

	public SomeServiceProxy(){
		super();
		//创建目标对象
		target = new SomeServiceImpl();

	}

	@Override
	public String doFirst() {
		//代理类调用目标方法
		String result = target.doFirst();
		//增强就发生在这里
		return result.toUpperCase();
	}

	@Override
	public void doSecond() {
		target.doSecond();
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//利用代理对象执行方法
		SomeServiceProxy someServiceProxy = new SomeServiceProxy();
		String result = someServiceProxy.doFirst();
		System.out.println("result = " + result );
		someServiceProxy.doSecond();
	}
}
```
---
doFirst
result = ABCD
doSecond

---

## 动态代理
',
  'groups' => 'DesignPattern',
  'showsel' => '0',
  'showse2' => '1',
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->updateNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000427s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001379s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000423s ]
[ sql ] [ SQL ] SELECT `groups` FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000286s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001013s ]
[ sql ] [ SQL ] SELECT `parent_id` FROM `groups` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.000299s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `id` = 2 LIMIT 1 [ RunTime:0.000305s ]
[ sql ] [ SQL ] UPDATE `note`  SET `id`=237,`p_id`=2,`title`='代理模式\r',`content`='# 代理模式\r\n客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。\r\n\r\n>以生活中的“代理律师”为例来理解“代理模式”\r\n\r\n打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。\r\n\r\n聘请代理律师时以下几点需要特别说明：\r\n（1）当事人与代理律师是在为同一件事情努力。\r\n（2）法院所有的具体事务都是通过代理律师完成。\r\n（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。\r\n\r\n对于代理模式，需要注意以下几点：\r\n（1）**代理类和目标类要实现同一个接口**，即业务接口。\r\n（2）**客户类对目标类的调用均是通过代理类完成的**。\r\n（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。\r\n\r\n**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**\r\n## 静态代理\r\n静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。\r\n\r\n静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。\r\n\r\n### Demo\r\n>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD\r\n\r\n目标接口：\r\n```\r\n/**\r\n * 目标接口\r\n */\r\npublic interface ISomeService {\r\n	//目标方法\r\n	String doFirst();\r\n	void doSecond();\r\n}\r\n```\r\n目标实现类:\r\n```\r\n/**\r\n * 目标实现类\r\n */\r\npublic class SomeServiceImpl implements ISomeService {\r\n	@Override\r\n	public String doFirst() {\r\n		System.out.println(\"doFirst\");\r\n		return \"abcd\";\r\n	}\r\n\r\n	@Override\r\n	public void doSecond() {\r\n		System.out.println(\"doSecond\");\r\n	}\r\n}\r\n```\r\n代理类:\r\n```\r\n/**\r\n * 代理类\r\n */\r\npublic class SomeServiceProxy implements ISomeService {\r\n\r\n	//目标对象\r\n	SomeServiceImpl target;\r\n\r\n	public SomeServiceProxy(){\r\n		super();\r\n		//创建目标对象\r\n		target = new SomeServiceImpl();\r\n\r\n	}\r\n\r\n	@Override\r\n	public String doFirst() {\r\n		//代理类调用目标方法\r\n		String result = target.doFirst();\r\n		//增强就发生在这里\r\n		return result.toUpperCase();\r\n	}\r\n\r\n	@Override\r\n	public void doSecond() {\r\n		target.doSecond();\r\n	}\r\n}\r\n```\r\n测试：\r\n```\r\npublic class MyTest {\r\n	public static void main(String[] args) {\r\n		//利用代理对象执行方法\r\n		SomeServiceProxy someServiceProxy = new SomeServiceProxy();\r\n		String result = someServiceProxy.doFirst();\r\n		System.out.println(\"result = \" + result );\r\n		someServiceProxy.doSecond();\r\n	}\r\n}\r\n```\r\n---\r\ndoFirst\r\nresult = ABCD\r\ndoSecond\r\n\r\n---\r\n\r\n## 动态代理\r\n',`groups`='DesignPattern',`is_show`=0,`publish`=1,`summary`=''  WHERE  `id` = 237 [ RunTime:0.000704s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.001489s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=2  WHERE  `groups` = 'DesignPattern' [ RunTime:0.000422s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.001490s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=2  WHERE  `groups` = 'DesignPattern' [ RunTime:0.000342s ]
---------------------------------------------------------------
[ 2018-11-01T20:15:27+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/237.html
[ info ] qingrang.top/daily/admin/note/shownote/id/237.html [运行时间：0.089543s][吞吐率：11.17req/s] [内存消耗：1,982.88kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000846s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001998s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.001617s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001998s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000469s ]
---------------------------------------------------------------
[ 2018-11-01T20:19:26+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/237.html
[ info ] qingrang.top/daily/admin/note/shownote/id/237.html [运行时间：0.053099s][吞吐率：18.83req/s] [内存消耗：1,982.88kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000663s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001378s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000424s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000893s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000392s ]
---------------------------------------------------------------
[ 2018-11-01T20:19:51+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/editnote/id/237.html
[ info ] qingrang.top/daily/admin/note/editnote/id/237.html [运行时间：0.053424s][吞吐率：18.72req/s] [内存消耗：2,030.51kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'editnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->editNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/editnote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000544s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001343s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000442s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000877s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000350s ]
---------------------------------------------------------------
[ 2018-11-01T20:20:05+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/savenote.html
[ info ] qingrang.top/daily/admin/note/savenote.html [运行时间：0.052694s][吞吐率：18.98req/s] [内存消耗：2,046.74kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'savenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '7537',
  'accept' => 'text/plain, */*; q=0.01',
  'origin' => 'http://qingrang.top',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded; charset=UTF-8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'ogroup' => 'Default',
  'context' => '# 代理模式
[TOC]

客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。

>以生活中的“代理律师”为例来理解“代理模式”

打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。

聘请代理律师时以下几点需要特别说明：
（1）当事人与代理律师是在为同一件事情努力。
（2）法院所有的具体事务都是通过代理律师完成。
（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。

对于代理模式，需要注意以下几点：
（1）**代理类和目标类要实现同一个接口**，即业务接口。
（2）**客户类对目标类的调用均是通过代理类完成的**。
（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。

**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**
## 静态代理
静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。

静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。

### Demo
>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD

目标接口：
```
/**
 * 目标接口
 */
public interface ISomeService {
	//目标方法
	String doFirst();
	void doSecond();
}
```
目标实现类:
```
/**
 * 目标实现类
 */
public class SomeServiceImpl implements ISomeService {
	@Override
	public String doFirst() {
		System.out.println("doFirst");
		return "abcd";
	}

	@Override
	public void doSecond() {
		System.out.println("doSecond");
	}
}
```
代理类:
```
/**
 * 代理类
 */
public class SomeServiceProxy implements ISomeService {

	//目标对象
	SomeServiceImpl target;

	public SomeServiceProxy(){
		super();
		//创建目标对象
		target = new SomeServiceImpl();

	}

	@Override
	public String doFirst() {
		//代理类调用目标方法
		String result = target.doFirst();
		//增强就发生在这里
		return result.toUpperCase();
	}

	@Override
	public void doSecond() {
		target.doSecond();
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//利用代理对象执行方法
		SomeServiceProxy someServiceProxy = new SomeServiceProxy();
		String result = someServiceProxy.doFirst();
		System.out.println("result = " + result );
		someServiceProxy.doSecond();
	}
}
```
---
doFirst
result = ABCD
doSecond

---

## 动态代理
',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->saveNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000428s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001367s ]
[ sql ] [ SQL ] UPDATE `note`  SET `title`='代理模式',`content`='# 代理模式\n[TOC]\n\n客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。\n\n>以生活中的“代理律师”为例来理解“代理模式”\n\n打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。\n\n聘请代理律师时以下几点需要特别说明：\n（1）当事人与代理律师是在为同一件事情努力。\n（2）法院所有的具体事务都是通过代理律师完成。\n（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。\n\n对于代理模式，需要注意以下几点：\n（1）**代理类和目标类要实现同一个接口**，即业务接口。\n（2）**客户类对目标类的调用均是通过代理类完成的**。\n（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。\n\n**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**\n## 静态代理\n静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。\n\n静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。\n\n### Demo\n>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD\n\n目标接口：\n```\n/**\n * 目标接口\n */\npublic interface ISomeService {\n	//目标方法\n	String doFirst();\n	void doSecond();\n}\n```\n目标实现类:\n```\n/**\n * 目标实现类\n */\npublic class SomeServiceImpl implements ISomeService {\n	@Override\n	public String doFirst() {\n		System.out.println(\"doFirst\");\n		return \"abcd\";\n	}\n\n	@Override\n	public void doSecond() {\n		System.out.println(\"doSecond\");\n	}\n}\n```\n代理类:\n```\n/**\n * 代理类\n */\npublic class SomeServiceProxy implements ISomeService {\n\n	//目标对象\n	SomeServiceImpl target;\n\n	public SomeServiceProxy(){\n		super();\n		//创建目标对象\n		target = new SomeServiceImpl();\n\n	}\n\n	@Override\n	public String doFirst() {\n		//代理类调用目标方法\n		String result = target.doFirst();\n		//增强就发生在这里\n		return result.toUpperCase();\n	}\n\n	@Override\n	public void doSecond() {\n		target.doSecond();\n	}\n}\n```\n测试：\n```\npublic class MyTest {\n	public static void main(String[] args) {\n		//利用代理对象执行方法\n		SomeServiceProxy someServiceProxy = new SomeServiceProxy();\n		String result = someServiceProxy.doFirst();\n		System.out.println(\"result = \" + result );\n		someServiceProxy.doSecond();\n	}\n}\n```\n---\ndoFirst\nresult = ABCD\ndoSecond\n\n---\n\n## 动态代理\n',`groups`='Default',`p_id`=1  WHERE  `id` = 1 [ RunTime:0.000543s ]
---------------------------------------------------------------
[ 2018-11-01T21:03:19+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.078089s][吞吐率：12.81req/s] [内存消耗：2,189.93kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000507s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001779s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.001732s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000586s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.001287s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000311s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000390s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000875s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000325s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000583s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000341s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000366s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001094s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000307s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.001158s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.000678s ]
---------------------------------------------------------------
[ 2018-11-01T21:03:36+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/editnote/id/208.html
[ info ] qingrang.top/daily/admin/note/editnote/id/208.html [运行时间：0.057006s][吞吐率：17.54req/s] [内存消耗：2,030.89kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'editnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '208',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->editNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/editnote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000623s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001526s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 208 LIMIT 1 [ RunTime:0.000422s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000830s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000276s ]
---------------------------------------------------------------
[ 2018-11-01T21:04:09+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/updatenote/id/208.html
[ info ] qingrang.top/daily/admin/note/updatenote/id/208.html [运行时间：0.058129s][吞吐率：17.20req/s] [内存消耗：2,070.01kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'updatenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '6758',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/208.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'summary' => '',
  'content' => '# Code 自定义快捷键
[TOC]
## 常用
### 删除行 `Ctrl + d`
### 向下复制行 `Ctrl + b`
### 移动行 `Alt + Up/Down`
### 上开新行 `Ctrl + shift + enter`
### 下开新行 `Ctrl + enter`
### 行注释 `Ctrl + /`
### 块注释 `Ctrl + Shift + /`
### 提示 `alt + /`
### 添加 getter、setter 方法 `alt + insert`
### 替换文本 `Ctrl + R`
### 格式化代码 `ctrl + alt + l`
### 抽取局部变量 `ctrl + alt + v`

## Eclipse
### 批量修改 ALT+SHIFT+R
### 快速输入
- 主方法
1. 敲入main
2. alt+/
- System.out.println
1. 敲入syso
2. alt+/
- 快速输入for
1. 敲入for
2. alt+/
### 代码格式化 ctrl+shift+f
### import类 ctrl+shift+o
### 快速注释 选中一行或者多行代码 ctrl+shift+c
### 快速解决办法提示 ctrl+1
在出错误的行，使用ctrl+1。 比如忘记导入类了，就可以用这个解决
### 方法的快速生成 shift+alt+s

---

## Sublime Text 3
### 键盘快捷键
https://blog.csdn.net/u010994304/article/details/50866634

// Ctrl+Enter
// 插入行后

// Ctrl+Shift Enter
// 插入行前

// Shift+Tab
// 去除缩进

// Tab
// 缩进

// Ctrl+KK
// 从光标处删除至行尾
```
[
	// 删除当前行
	{ "keys": ["ctrl+d"], "command":"run_macro_file", "args": {"file":"Packages/Default/Delete Line.sublime-macro"} },
	
	// 与上行互换
	{ "keys": ["alt+up"], "command":"swap_line_up" },
	// 与下行互换
	{ "keys": ["alt+down"], "command":"swap_line_down" },

	// 向下复制行
	{ "keys": ["ctrl+alt+down"], "command":"duplicate_line" },
	
	// 自动提示、补全
	{ "keys": ["alt+/"], "command":"auto_complete" },
	{ "keys": ["alt+/"], "command":"replace_completion_with_auto_complete", "context":
	[
	{ "key": "last_command", "operator":"equal", "operand": "insert_best_completion" },
	{ "key": "auto_complete_visible", "operator":"equal", "operand": false },
	{ "key": "setting.tab_completion", "operator":"equal", "operand": true }
	]
	},

	//移动光标到行首或行末
	{ "keys": ["alt+b"], "command":"move_to", "args": {"to": "bol","extend": false} },
	{ "keys": ["alt+e"], "command":"move_to", "args": {"to": "eol","extend": false} },
	//移动光标到行首或行末并选择内容
	{ "keys": ["shift+alt+b"], "command":"move_to", "args": {"to": "bol","extend": true} },
	{ "keys": ["shift+alt+e"], "command":"move_to", "args": {"to": "eol","extend": true} },

]
```
### 配置 ctrl + 鼠标左键 进行函数跳转
点击 Preferences->Browse Packages 进入 Packages 目录，然后打开 User 目录，查看User目录里面有没有`Default (Windows).sublime-mousemap`文件，如果没有则创建一个。这个文件是用来配置 sublime 的鼠标操作的。在文件中输入如下内容：
```
[
{
"button": "button2",
"count": 1,
"modifiers": ["ctrl"],
"command": "jump_back"
},


{
"button": "button1",
"count": 1,
"modifiers": ["ctrl"],
"press_command": "drag_select",
"command": "goto_definition"
}
]
```
点击保存即可。

ctrl+鼠标左键跳转到函数定义处；

ctrl+鼠标右键跳回来。
',
  'groups' => 'Basics',
  'showsel' => '1',
  'showse2' => '1',
  'id' => '208',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->updateNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000530s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001497s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 208 LIMIT 1 [ RunTime:0.000426s ]
[ sql ] [ SQL ] SELECT `groups` FROM `note` WHERE  `id` = 208 LIMIT 1 [ RunTime:0.000351s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000862s ]
[ sql ] [ SQL ] SELECT `parent_id` FROM `groups` WHERE  `groups` = 'Basics' LIMIT 1 [ RunTime:0.000310s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `id` = 2 LIMIT 1 [ RunTime:0.000281s ]
[ sql ] [ SQL ] UPDATE `note`  SET `id`=208,`p_id`=2,`title`='Code 自定义快捷键\r',`content`='# Code 自定义快捷键\r\n[TOC]\r\n## 常用\r\n### 删除行 `Ctrl + d`\r\n### 向下复制行 `Ctrl + b`\r\n### 移动行 `Alt + Up/Down`\r\n### 上开新行 `Ctrl + shift + enter`\r\n### 下开新行 `Ctrl + enter`\r\n### 行注释 `Ctrl + /`\r\n### 块注释 `Ctrl + Shift + /`\r\n### 提示 `alt + /`\r\n### 添加 getter、setter 方法 `alt + insert`\r\n### 替换文本 `Ctrl + R`\r\n### 格式化代码 `ctrl + alt + l`\r\n### 抽取局部变量 `ctrl + alt + v`\r\n\r\n## Eclipse\r\n### 批量修改 ALT+SHIFT+R\r\n### 快速输入\r\n- 主方法\r\n1. 敲入main\r\n2. alt+/\r\n- System.out.println\r\n1. 敲入syso\r\n2. alt+/\r\n- 快速输入for\r\n1. 敲入for\r\n2. alt+/\r\n### 代码格式化 ctrl+shift+f\r\n### import类 ctrl+shift+o\r\n### 快速注释 选中一行或者多行代码 ctrl+shift+c\r\n### 快速解决办法提示 ctrl+1\r\n在出错误的行，使用ctrl+1。 比如忘记导入类了，就可以用这个解决\r\n### 方法的快速生成 shift+alt+s\r\n\r\n---\r\n\r\n## Sublime Text 3\r\n### 键盘快捷键\r\nhttps://blog.csdn.net/u010994304/article/details/50866634\r\n\r\n// Ctrl+Enter\r\n// 插入行后\r\n\r\n// Ctrl+Shift Enter\r\n// 插入行前\r\n\r\n// Shift+Tab\r\n// 去除缩进\r\n\r\n// Tab\r\n// 缩进\r\n\r\n// Ctrl+KK\r\n// 从光标处删除至行尾\r\n```\r\n[\r\n	// 删除当前行\r\n	{ \"keys\": [\"ctrl+d\"], \"command\":\"run_macro_file\", \"args\": {\"file\":\"Packages/Default/Delete Line.sublime-macro\"} },\r\n	\r\n	// 与上行互换\r\n	{ \"keys\": [\"alt+up\"], \"command\":\"swap_line_up\" },\r\n	// 与下行互换\r\n	{ \"keys\": [\"alt+down\"], \"command\":\"swap_line_down\" },\r\n\r\n	// 向下复制行\r\n	{ \"keys\": [\"ctrl+alt+down\"], \"command\":\"duplicate_line\" },\r\n	\r\n	// 自动提示、补全\r\n	{ \"keys\": [\"alt+/\"], \"command\":\"auto_complete\" },\r\n	{ \"keys\": [\"alt+/\"], \"command\":\"replace_completion_with_auto_complete\", \"context\":\r\n	[\r\n	{ \"key\": \"last_command\", \"operator\":\"equal\", \"operand\": \"insert_best_completion\" },\r\n	{ \"key\": \"auto_complete_visible\", \"operator\":\"equal\", \"operand\": false },\r\n	{ \"key\": \"setting.tab_completion\", \"operator\":\"equal\", \"operand\": true }\r\n	]\r\n	},\r\n\r\n	//移动光标到行首或行末\r\n	{ \"keys\": [\"alt+b\"], \"command\":\"move_to\", \"args\": {\"to\": \"bol\",\"extend\": false} },\r\n	{ \"keys\": [\"alt+e\"], \"command\":\"move_to\", \"args\": {\"to\": \"eol\",\"extend\": false} },\r\n	//移动光标到行首或行末并选择内容\r\n	{ \"keys\": [\"shift+alt+b\"], \"command\":\"move_to\", \"args\": {\"to\": \"bol\",\"extend\": true} },\r\n	{ \"keys\": [\"shift+alt+e\"], \"command\":\"move_to\", \"args\": {\"to\": \"eol\",\"extend\": true} },\r\n\r\n]\r\n```\r\n### 配置 ctrl + 鼠标左键 进行函数跳转\r\n点击 Preferences->Browse Packages 进入 Packages 目录，然后打开 User 目录，查看User目录里面有没有`Default (Windows).sublime-mousemap`文件，如果没有则创建一个。这个文件是用来配置 sublime 的鼠标操作的。在文件中输入如下内容：\r\n```\r\n[\r\n{\r\n\"button\": \"button2\",\r\n\"count\": 1,\r\n\"modifiers\": [\"ctrl\"],\r\n\"command\": \"jump_back\"\r\n},\r\n\r\n\r\n{\r\n\"button\": \"button1\",\r\n\"count\": 1,\r\n\"modifiers\": [\"ctrl\"],\r\n\"press_command\": \"drag_select\",\r\n\"command\": \"goto_definition\"\r\n}\r\n]\r\n```\r\n点击保存即可。\r\n\r\nctrl+鼠标左键跳转到函数定义处；\r\n\r\nctrl+鼠标右键跳回来。\r\n',`groups`='Basics',`is_show`=1,`publish`=1,`summary`=''  WHERE  `id` = 208 [ RunTime:0.000617s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Basics' LIMIT 1 [ RunTime:0.001316s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=19  WHERE  `groups` = 'Basics' [ RunTime:0.000360s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Basics' LIMIT 1 [ RunTime:0.000973s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=19  WHERE  `groups` = 'Basics' [ RunTime:0.000414s ]
---------------------------------------------------------------
[ 2018-11-01T21:04:09+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/208.html
[ info ] qingrang.top/daily/admin/note/shownote/id/208.html [运行时间：0.050046s][吞吐率：19.98req/s] [内存消耗：1,982.86kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/208.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '208',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000430s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001375s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 208 LIMIT 1 [ RunTime:0.000407s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000930s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000300s ]
---------------------------------------------------------------
[ 2018-11-01T21:15:57+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.081562s][吞吐率：12.26req/s] [内存消耗：2,189.97kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000647s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001449s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.001683s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000509s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.001092s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000425s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000529s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000974s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000293s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000440s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000310s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000354s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001607s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000303s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.001799s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.001147s ]
---------------------------------------------------------------
[ 2018-11-01T21:16:09+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/editnote/id/208.html
[ info ] qingrang.top/daily/admin/note/editnote/id/208.html [运行时间：0.062637s][吞吐率：15.97req/s] [内存消耗：2,030.93kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'editnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '208',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->editNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/editnote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000487s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001398s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 208 LIMIT 1 [ RunTime:0.000503s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000967s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000344s ]
---------------------------------------------------------------
[ 2018-11-01T21:16:32+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/updatenote/id/208.html
[ info ] qingrang.top/daily/admin/note/updatenote/id/208.html [运行时间：0.064188s][吞吐率：15.58req/s] [内存消耗：2,070.68kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'updatenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '6923',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/208.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'summary' => '',
  'content' => '# Code 自定义快捷键
[TOC]
## 常用
### 删除行 `Ctrl + d`
### 向下复制行 `Ctrl + b`
### 移动行 `Alt + Up/Down`
### 上开新行 `Ctrl + shift + enter`
### 下开新行 `Ctrl + enter`
### 行注释 `Ctrl + /`
### 块注释 `Ctrl + Shift + /`
### 提示 `alt + /`
### 添加 getter、setter 方法 `alt + insert`
### 替换文本 `Ctrl + R`
### 格式化代码 `ctrl + alt + l`
### 抽取局部变量 `ctrl + alt + v`
### 用if、while、try catch来围绕选中的代码行 `Ctrl + Alt + T`

## Eclipse
### 批量修改 ALT+SHIFT+R
### 快速输入
- 主方法
1. 敲入main
2. alt+/
- System.out.println
1. 敲入syso
2. alt+/
- 快速输入for
1. 敲入for
2. alt+/
### 代码格式化 ctrl+shift+f
### import类 ctrl+shift+o
### 快速注释 选中一行或者多行代码 ctrl+shift+c
### 快速解决办法提示 ctrl+1
在出错误的行，使用ctrl+1。 比如忘记导入类了，就可以用这个解决
### 方法的快速生成 shift+alt+s

---

## Sublime Text 3
### 键盘快捷键
https://blog.csdn.net/u010994304/article/details/50866634

// Ctrl+Enter
// 插入行后

// Ctrl+Shift Enter
// 插入行前

// Shift+Tab
// 去除缩进

// Tab
// 缩进

// Ctrl+KK
// 从光标处删除至行尾
```
[
	// 删除当前行
	{ "keys": ["ctrl+d"], "command":"run_macro_file", "args": {"file":"Packages/Default/Delete Line.sublime-macro"} },
	
	// 与上行互换
	{ "keys": ["alt+up"], "command":"swap_line_up" },
	// 与下行互换
	{ "keys": ["alt+down"], "command":"swap_line_down" },

	// 向下复制行
	{ "keys": ["ctrl+alt+down"], "command":"duplicate_line" },
	
	// 自动提示、补全
	{ "keys": ["alt+/"], "command":"auto_complete" },
	{ "keys": ["alt+/"], "command":"replace_completion_with_auto_complete", "context":
	[
	{ "key": "last_command", "operator":"equal", "operand": "insert_best_completion" },
	{ "key": "auto_complete_visible", "operator":"equal", "operand": false },
	{ "key": "setting.tab_completion", "operator":"equal", "operand": true }
	]
	},

	//移动光标到行首或行末
	{ "keys": ["alt+b"], "command":"move_to", "args": {"to": "bol","extend": false} },
	{ "keys": ["alt+e"], "command":"move_to", "args": {"to": "eol","extend": false} },
	//移动光标到行首或行末并选择内容
	{ "keys": ["shift+alt+b"], "command":"move_to", "args": {"to": "bol","extend": true} },
	{ "keys": ["shift+alt+e"], "command":"move_to", "args": {"to": "eol","extend": true} },

]
```
### 配置 ctrl + 鼠标左键 进行函数跳转
点击 Preferences->Browse Packages 进入 Packages 目录，然后打开 User 目录，查看User目录里面有没有`Default (Windows).sublime-mousemap`文件，如果没有则创建一个。这个文件是用来配置 sublime 的鼠标操作的。在文件中输入如下内容：
```
[
{
"button": "button2",
"count": 1,
"modifiers": ["ctrl"],
"command": "jump_back"
},


{
"button": "button1",
"count": 1,
"modifiers": ["ctrl"],
"press_command": "drag_select",
"command": "goto_definition"
}
]
```
点击保存即可。

ctrl+鼠标左键跳转到函数定义处；

ctrl+鼠标右键跳回来。
',
  'groups' => 'Basics',
  'showsel' => '1',
  'showse2' => '1',
  'id' => '208',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->updateNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000487s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001459s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 208 LIMIT 1 [ RunTime:0.000484s ]
[ sql ] [ SQL ] SELECT `groups` FROM `note` WHERE  `id` = 208 LIMIT 1 [ RunTime:0.000439s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001028s ]
[ sql ] [ SQL ] SELECT `parent_id` FROM `groups` WHERE  `groups` = 'Basics' LIMIT 1 [ RunTime:0.000345s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `id` = 2 LIMIT 1 [ RunTime:0.000278s ]
[ sql ] [ SQL ] UPDATE `note`  SET `id`=208,`p_id`=2,`title`='Code 自定义快捷键\r',`content`='# Code 自定义快捷键\r\n[TOC]\r\n## 常用\r\n### 删除行 `Ctrl + d`\r\n### 向下复制行 `Ctrl + b`\r\n### 移动行 `Alt + Up/Down`\r\n### 上开新行 `Ctrl + shift + enter`\r\n### 下开新行 `Ctrl + enter`\r\n### 行注释 `Ctrl + /`\r\n### 块注释 `Ctrl + Shift + /`\r\n### 提示 `alt + /`\r\n### 添加 getter、setter 方法 `alt + insert`\r\n### 替换文本 `Ctrl + R`\r\n### 格式化代码 `ctrl + alt + l`\r\n### 抽取局部变量 `ctrl + alt + v`\r\n### 用if、while、try catch来围绕选中的代码行 `Ctrl + Alt + T`\r\n\r\n## Eclipse\r\n### 批量修改 ALT+SHIFT+R\r\n### 快速输入\r\n- 主方法\r\n1. 敲入main\r\n2. alt+/\r\n- System.out.println\r\n1. 敲入syso\r\n2. alt+/\r\n- 快速输入for\r\n1. 敲入for\r\n2. alt+/\r\n### 代码格式化 ctrl+shift+f\r\n### import类 ctrl+shift+o\r\n### 快速注释 选中一行或者多行代码 ctrl+shift+c\r\n### 快速解决办法提示 ctrl+1\r\n在出错误的行，使用ctrl+1。 比如忘记导入类了，就可以用这个解决\r\n### 方法的快速生成 shift+alt+s\r\n\r\n---\r\n\r\n## Sublime Text 3\r\n### 键盘快捷键\r\nhttps://blog.csdn.net/u010994304/article/details/50866634\r\n\r\n// Ctrl+Enter\r\n// 插入行后\r\n\r\n// Ctrl+Shift Enter\r\n// 插入行前\r\n\r\n// Shift+Tab\r\n// 去除缩进\r\n\r\n// Tab\r\n// 缩进\r\n\r\n// Ctrl+KK\r\n// 从光标处删除至行尾\r\n```\r\n[\r\n	// 删除当前行\r\n	{ \"keys\": [\"ctrl+d\"], \"command\":\"run_macro_file\", \"args\": {\"file\":\"Packages/Default/Delete Line.sublime-macro\"} },\r\n	\r\n	// 与上行互换\r\n	{ \"keys\": [\"alt+up\"], \"command\":\"swap_line_up\" },\r\n	// 与下行互换\r\n	{ \"keys\": [\"alt+down\"], \"command\":\"swap_line_down\" },\r\n\r\n	// 向下复制行\r\n	{ \"keys\": [\"ctrl+alt+down\"], \"command\":\"duplicate_line\" },\r\n	\r\n	// 自动提示、补全\r\n	{ \"keys\": [\"alt+/\"], \"command\":\"auto_complete\" },\r\n	{ \"keys\": [\"alt+/\"], \"command\":\"replace_completion_with_auto_complete\", \"context\":\r\n	[\r\n	{ \"key\": \"last_command\", \"operator\":\"equal\", \"operand\": \"insert_best_completion\" },\r\n	{ \"key\": \"auto_complete_visible\", \"operator\":\"equal\", \"operand\": false },\r\n	{ \"key\": \"setting.tab_completion\", \"operator\":\"equal\", \"operand\": true }\r\n	]\r\n	},\r\n\r\n	//移动光标到行首或行末\r\n	{ \"keys\": [\"alt+b\"], \"command\":\"move_to\", \"args\": {\"to\": \"bol\",\"extend\": false} },\r\n	{ \"keys\": [\"alt+e\"], \"command\":\"move_to\", \"args\": {\"to\": \"eol\",\"extend\": false} },\r\n	//移动光标到行首或行末并选择内容\r\n	{ \"keys\": [\"shift+alt+b\"], \"command\":\"move_to\", \"args\": {\"to\": \"bol\",\"extend\": true} },\r\n	{ \"keys\": [\"shift+alt+e\"], \"command\":\"move_to\", \"args\": {\"to\": \"eol\",\"extend\": true} },\r\n\r\n]\r\n```\r\n### 配置 ctrl + 鼠标左键 进行函数跳转\r\n点击 Preferences->Browse Packages 进入 Packages 目录，然后打开 User 目录，查看User目录里面有没有`Default (Windows).sublime-mousemap`文件，如果没有则创建一个。这个文件是用来配置 sublime 的鼠标操作的。在文件中输入如下内容：\r\n```\r\n[\r\n{\r\n\"button\": \"button2\",\r\n\"count\": 1,\r\n\"modifiers\": [\"ctrl\"],\r\n\"command\": \"jump_back\"\r\n},\r\n\r\n\r\n{\r\n\"button\": \"button1\",\r\n\"count\": 1,\r\n\"modifiers\": [\"ctrl\"],\r\n\"press_command\": \"drag_select\",\r\n\"command\": \"goto_definition\"\r\n}\r\n]\r\n```\r\n点击保存即可。\r\n\r\nctrl+鼠标左键跳转到函数定义处；\r\n\r\nctrl+鼠标右键跳回来。\r\n',`groups`='Basics',`is_show`=1,`publish`=1,`summary`=''  WHERE  `id` = 208 [ RunTime:0.000695s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Basics' LIMIT 1 [ RunTime:0.001374s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=19  WHERE  `groups` = 'Basics' [ RunTime:0.000455s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Basics' LIMIT 1 [ RunTime:0.001173s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=19  WHERE  `groups` = 'Basics' [ RunTime:0.000324s ]
---------------------------------------------------------------
[ 2018-11-01T21:16:33+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/208.html
[ info ] qingrang.top/daily/admin/note/shownote/id/208.html [运行时间：0.050184s][吞吐率：19.93req/s] [内存消耗：1,982.93kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/208.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '208',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000546s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001305s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 208 LIMIT 1 [ RunTime:0.000454s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000935s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000325s ]
---------------------------------------------------------------
[ 2018-11-01T22:04:48+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/savenote.html
[ info ] qingrang.top/daily/admin/note/savenote.html [运行时间：0.071974s][吞吐率：13.89req/s] [内存消耗：2,090.04kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'savenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '19367',
  'accept' => 'text/plain, */*; q=0.01',
  'origin' => 'http://qingrang.top',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded; charset=UTF-8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'ogroup' => 'Default',
  'context' => '# 代理模式
[TOC]

客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。

>以生活中的“代理律师”为例来理解“代理模式”

打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。

聘请代理律师时以下几点需要特别说明：
（1）当事人与代理律师是在为同一件事情努力。
（2）法院所有的具体事务都是通过代理律师完成。
（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。

对于代理模式，需要注意以下几点：
（1）**代理类和目标类要实现同一个接口**，即业务接口。
（2）**客户类对目标类的调用均是通过代理类完成的**。
（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。

**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**
## 静态代理
静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。

静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。

### Demo
>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD

目标接口：
```
/**
 * 目标接口
 */
public interface ISomeService {
	//目标方法
	String doFirst();
	void doSecond();
}
```
目标实现类:
```
/**
 * 目标实现类
 */
public class SomeServiceImpl implements ISomeService {
	@Override
	public String doFirst() {
		System.out.println("doFirst");
		return "abcd";
	}

	@Override
	public void doSecond() {
		System.out.println("doSecond");
	}
}
```
代理类:
```
/**
 * 代理类
 */
public class SomeServiceProxy implements ISomeService {

	//目标对象
	SomeServiceImpl target;

	public SomeServiceProxy(){
		super();
		//创建目标对象
		target = new SomeServiceImpl();

	}

	@Override
	public String doFirst() {
		//代理类调用目标方法
		String result = target.doFirst();
		//增强就发生在这里
		return result.toUpperCase();
	}

	@Override
	public void doSecond() {
		target.doSecond();
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//利用代理对象执行方法
		SomeServiceProxy someServiceProxy = new SomeServiceProxy();
		String result = someServiceProxy.doFirst();
		System.out.println("result = " + result );
		someServiceProxy.doSecond();
	}
}
```
---
doFirst
result = ABCD
doSecond

---

## 动态代理
动态代理是指， **程序在整个运行过程中根本就不存在目标类的代理类，目标对象的代理对象只是由代理生成工具（如代理工厂类）在程序运行时由 JVM 根据反射等机制动态生成的**。代理对象与目标对象的代理关系在程序运行时才确立。

### JDK 动态代理
通过 JDK 的 java.lang.reflect.Proxy 类实现动态代理,会使用其静态方法 newProxyInstance()，依据目标对象、业务接口及业务增强逻辑三者，自动生成一个动态代理对象。

`public static newProxyInstance ( ClassLoader loader, Class<?>[] interfaces,InvocationHandler handler)`

loader：目标类的类加载器，通过目标对象的反射可获取
interfaces：目标类实现的接口数组，通过目标对象的反射可获取
handler：业务增强逻辑，需要再定义。

InvocationHandler 是个接口，其具体介绍如下：

实现了 InvocationHandler 接口的类用于加强目标类的主业务逻辑。这个接口中有一个方法 invoke()，具体加强的代码逻辑就是定义在该方法中的。程序调用主业务逻辑时，会自动调用 invoke()方法。

invoke()方法的介绍如下：

`public Object invoke ( Object proxy, Method method, Object[] args)`

proxy：代表生成的代理对象
method：代表目标方法
args：代表目标方法的参数

由于该方法是由代理对象自动调用的，所以这三个参数的值不用程序员给出。第二个参数为 Method 类对象，该类有一个方法也叫 invoke()，可以调用目标类的目标方法。这两个 invoke()方法，虽然同名，但无关。

`public Object invoke ( Object obj, Object... args)`

obj：表示目标对象
args：表示目标方法参数，就是其上一层 invoke 方法的第三个参数

该方法的作用是：调用执行 obj 对象所属类的方法，这个方法由其调用者 Method 对
象确定。

在代码中，一般的写法为 `method.invoke(target, args);`

其中， method 为上一层 invoke 方法的第二个参数。这样，即可调用了目标类的目标方法。


```
/**
 * 测试类
 */
public class MyTest {
	public static void main(String[] args) {
		final ISomeService target = new SomeServiceImpl();

		// 使用 JDK 的 Proxy 动态代理，要求目标类必须实现接口
		// 因为其底层的执行原理，与静态代理的相同
		ISomeService service = (ISomeService) Proxy.newProxyInstance(
				target.getClass().getClassLoader(),    // 目标类的类加载器
				target.getClass().getInterfaces(),     // 目标类所实现的所有接口
				new InvocationHandler() {              // 匿名内部类
					// proxy：代理对象，method：目标方法，args：目标方法的参数列表
					@Override
					public Object invoke(Object proxy, Method method, Object[] args)
							throws Throwable {
						// 调用目标方法
						Object result = method.invoke(target, args);
						if (result != null) {
							result = ((String) result).toUpperCase();
						}
						return result;
					}
				});
		String result = service.doFirst();
		System.out.println("result = " + result);
		service.doSecond();
	}

}
```
### CGLIB 动态代理
CGLIB(Code Generation Library)是一个开源项目，是一个强大的、高性能的、高质量的代码生成类库。它可以在运行期扩展和增强 Java 类, Spring 用它来实现 AOP 编程。

使用 JDK 的 Proxy 实现代理，要求目标类与代理类实现相同的接口。若目标类不存在接口， 则无法使用该方式实现。但对于**无接口的类**，要为其创建动态代理，就要使用 CGLIB 来实现。

**CGLIB 代理的生成原理是生成目标类的子类，而子类是增强过的，这个子类对象就是代理对象。** 所以， 使用CGLIB 生成动态代理，要求目标类必须能够被继承，即不能是 final 的类。

**需导 jar 包**
#### 无接口
创建代理类的工厂：
```
public class MyCglibFactory implements MethodInterceptor {
	
	private SomeService target;

	public MyCglibFactory() {
		target = new SomeService();
	}

	/**
	 * 返回代理对象
	 */
	public SomeService myCglibCreator() {
		// 创建增强器对象
		Enhancer enhancer = new Enhancer();
		// 指定目标类，即父类
		enhancer.setSuperclass(SomeService.class);
		// 设置回调接口对象
		enhancer.setCallback(this);
		//返回指定类的子类(代理对象)
		return (SomeService) enhancer.create();
	}

	// 回调方法
	@Override
	public Object intercept(Object obj, Method method, Object[] args,
			MethodProxy proxy) throws Throwable {
		// 调用目标方法
		Object result = method.invoke(target, args);
		if (result != null) {
			result = ((String) result).toUpperCase();
		}
		return result;
	}
}
```
目标类：
```
public class SomeService {
	public String doFirst() {
		System.out.println("执行doFirst()方法");
		return "abcde";
	}

	public void doSecond() {
		System.out.println("执行doSecond()方法");
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//代理类(工厂创建的目标类的子类)
		SomeService service = new MyCglibFactory().myCglibCreator();
		String result = service.doFirst();
		System.out.println("result = " + result);
		service.doSecond();
	}
}
```



',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->saveNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000998s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001787s ]
[ sql ] [ SQL ] UPDATE `note`  SET `title`='代理模式',`content`='# 代理模式\n[TOC]\n\n客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。\n\n>以生活中的“代理律师”为例来理解“代理模式”\n\n打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。\n\n聘请代理律师时以下几点需要特别说明：\n（1）当事人与代理律师是在为同一件事情努力。\n（2）法院所有的具体事务都是通过代理律师完成。\n（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。\n\n对于代理模式，需要注意以下几点：\n（1）**代理类和目标类要实现同一个接口**，即业务接口。\n（2）**客户类对目标类的调用均是通过代理类完成的**。\n（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。\n\n**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**\n## 静态代理\n静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。\n\n静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。\n\n### Demo\n>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD\n\n目标接口：\n```\n/**\n * 目标接口\n */\npublic interface ISomeService {\n	//目标方法\n	String doFirst();\n	void doSecond();\n}\n```\n目标实现类:\n```\n/**\n * 目标实现类\n */\npublic class SomeServiceImpl implements ISomeService {\n	@Override\n	public String doFirst() {\n		System.out.println(\"doFirst\");\n		return \"abcd\";\n	}\n\n	@Override\n	public void doSecond() {\n		System.out.println(\"doSecond\");\n	}\n}\n```\n代理类:\n```\n/**\n * 代理类\n */\npublic class SomeServiceProxy implements ISomeService {\n\n	//目标对象\n	SomeServiceImpl target;\n\n	public SomeServiceProxy(){\n		super();\n		//创建目标对象\n		target = new SomeServiceImpl();\n\n	}\n\n	@Override\n	public String doFirst() {\n		//代理类调用目标方法\n		String result = target.doFirst();\n		//增强就发生在这里\n		return result.toUpperCase();\n	}\n\n	@Override\n	public void doSecond() {\n		target.doSecond();\n	}\n}\n```\n测试：\n```\npublic class MyTest {\n	public static void main(String[] args) {\n		//利用代理对象执行方法\n		SomeServiceProxy someServiceProxy = new SomeServiceProxy();\n		String result = someServiceProxy.doFirst();\n		System.out.println(\"result = \" + result );\n		someServiceProxy.doSecond();\n	}\n}\n```\n---\ndoFirst\nresult = ABCD\ndoSecond\n\n---\n\n## 动态代理\n动态代理是指， **程序在整个运行过程中根本就不存在目标类的代理类，目标对象的代理对象只是由代理生成工具（如代理工厂类）在程序运行时由 JVM 根据反射等机制动态生成的**。代理对象与目标对象的代理关系在程序运行时才确立。\n\n### JDK 动态代理\n通过 JDK 的 java.lang.reflect.Proxy 类实现动态代理,会使用其静态方法 newProxyInstance()，依据目标对象、业务接口及业务增强逻辑三者，自动生成一个动态代理对象。\n\n`public static newProxyInstance ( ClassLoader loader, Class<?>[] interfaces,InvocationHandler handler)`\n\nloader：目标类的类加载器，通过目标对象的反射可获取\ninterfaces：目标类实现的接口数组，通过目标对象的反射可获取\nhandler：业务增强逻辑，需要再定义。\n\nInvocationHandler 是个接口，其具体介绍如下：\n\n实现了 InvocationHandler 接口的类用于加强目标类的主业务逻辑。这个接口中有一个方法 invoke()，具体加强的代码逻辑就是定义在该方法中的。程序调用主业务逻辑时，会自动调用 invoke()方法。\n\ninvoke()方法的介绍如下：\n\n`public Object invoke ( Object proxy, Method method, Object[] args)`\n\nproxy：代表生成的代理对象\nmethod：代表目标方法\nargs：代表目标方法的参数\n\n由于该方法是由代理对象自动调用的，所以这三个参数的值不用程序员给出。第二个参数为 Method 类对象，该类有一个方法也叫 invoke()，可以调用目标类的目标方法。这两个 invoke()方法，虽然同名，但无关。\n\n`public Object invoke ( Object obj, Object... args)`\n\nobj：表示目标对象\nargs：表示目标方法参数，就是其上一层 invoke 方法的第三个参数\n\n该方法的作用是：调用执行 obj 对象所属类的方法，这个方法由其调用者 Method 对\n象确定。\n\n在代码中，一般的写法为 `method.invoke(target, args);`\n\n其中， method 为上一层 invoke 方法的第二个参数。这样，即可调用了目标类的目标方法。\n\n\n```\n/**\n * 测试类\n */\npublic class MyTest {\n	public static void main(String[] args) {\n		final ISomeService target = new SomeServiceImpl();\n\n		// 使用 JDK 的 Proxy 动态代理，要求目标类必须实现接口\n		// 因为其底层的执行原理，与静态代理的相同\n		ISomeService service = (ISomeService) Proxy.newProxyInstance(\n				target.getClass().getClassLoader(),    // 目标类的类加载器\n				target.getClass().getInterfaces(),     // 目标类所实现的所有接口\n				new InvocationHandler() {              // 匿名内部类\n					// proxy：代理对象，method：目标方法，args：目标方法的参数列表\n					@Override\n					public Object invoke(Object proxy, Method method, Object[] args)\n							throws Throwable {\n						// 调用目标方法\n						Object result = method.invoke(target, args);\n						if (result != null) {\n							result = ((String) result).toUpperCase();\n						}\n						return result;\n					}\n				});\n		String result = service.doFirst();\n		System.out.println(\"result = \" + result);\n		service.doSecond();\n	}\n\n}\n```\n### CGLIB 动态代理\nCGLIB(Code Generation Library)是一个开源项目，是一个强大的、高性能的、高质量的代码生成类库。它可以在运行期扩展和增强 Java 类, Spring 用它来实现 AOP 编程。\n\n使用 JDK 的 Proxy 实现代理，要求目标类与代理类实现相同的接口。若目标类不存在接口， 则无法使用该方式实现。但对于**无接口的类**，要为其创建动态代理，就要使用 CGLIB 来实现。\n\n**CGLIB 代理的生成原理是生成目标类的子类，而子类是增强过的，这个子类对象就是代理对象。** 所以， 使用CGLIB 生成动态代理，要求目标类必须能够被继承，即不能是 final 的类。\n\n**需导 jar 包**\n#### 无接口\n创建代理类的工厂：\n```\npublic class MyCglibFactory implements MethodInterceptor {\n	\n	private SomeService target;\n\n	public MyCglibFactory() {\n		target = new SomeService();\n	}\n\n	/**\n	 * 返回代理对象\n	 */\n	public SomeService myCglibCreator() {\n		// 创建增强器对象\n		Enhancer enhancer = new Enhancer();\n		// 指定目标类，即父类\n		enhancer.setSuperclass(SomeService.class);\n		// 设置回调接口对象\n		enhancer.setCallback(this);\n		//返回指定类的子类(代理对象)\n		return (SomeService) enhancer.create();\n	}\n\n	// 回调方法\n	@Override\n	public Object intercept(Object obj, Method method, Object[] args,\n			MethodProxy proxy) throws Throwable {\n		// 调用目标方法\n		Object result = method.invoke(target, args);\n		if (result != null) {\n			result = ((String) result).toUpperCase();\n		}\n		return result;\n	}\n}\n```\n目标类：\n```\npublic class SomeService {\n	public String doFirst() {\n		System.out.println(\"执行doFirst()方法\");\n		return \"abcde\";\n	}\n\n	public void doSecond() {\n		System.out.println(\"执行doSecond()方法\");\n	}\n}\n```\n测试：\n```\npublic class MyTest {\n	public static void main(String[] args) {\n		//代理类(工厂创建的目标类的子类)\n		SomeService service = new MyCglibFactory().myCglibCreator();\n		String result = service.doFirst();\n		System.out.println(\"result = \" + result);\n		service.doSecond();\n	}\n}\n```\n\n\n\n',`groups`='Default',`p_id`=1  WHERE  `id` = 1 [ RunTime:0.001018s ]
---------------------------------------------------------------
[ 2018-11-01T22:13:45+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/updatenote/id/237.html
[ info ] qingrang.top/daily/admin/note/updatenote/id/237.html [运行时间：0.067029s][吞吐率：14.92req/s] [内存消耗：2,121.59kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'updatenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '23258',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'summary' => '',
  'content' => '# 代理模式
[TOC]

客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。

>以生活中的“代理律师”为例来理解“代理模式”

打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。

聘请代理律师时以下几点需要特别说明：
（1）当事人与代理律师是在为同一件事情努力。
（2）法院所有的具体事务都是通过代理律师完成。
（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。

对于代理模式，需要注意以下几点：
（1）**代理类和目标类要实现同一个接口**，即业务接口。
（2）**客户类对目标类的调用均是通过代理类完成的**。
（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。

**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**
## 静态代理
静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。

静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。

### Demo
>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD

目标接口：
```
/**
 * 目标接口
 */
public interface ISomeService {
	//目标方法
	String doFirst();
	void doSecond();
}
```
目标实现类:
```
/**
 * 目标实现类
 */
public class SomeServiceImpl implements ISomeService {
	@Override
	public String doFirst() {
		System.out.println("doFirst");
		return "abcd";
	}

	@Override
	public void doSecond() {
		System.out.println("doSecond");
	}
}
```
代理类:
```
/**
 * 代理类
 */
public class SomeServiceProxy implements ISomeService {

	//目标对象
	SomeServiceImpl target;

	public SomeServiceProxy(){
		super();
		//创建目标对象
		target = new SomeServiceImpl();

	}

	@Override
	public String doFirst() {
		//代理类调用目标方法
		String result = target.doFirst();
		//增强就发生在这里
		return result.toUpperCase();
	}

	@Override
	public void doSecond() {
		target.doSecond();
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//利用代理对象执行方法
		SomeServiceProxy someServiceProxy = new SomeServiceProxy();
		String result = someServiceProxy.doFirst();
		System.out.println("result = " + result );
		someServiceProxy.doSecond();
	}
}
```
---
doFirst
result = ABCD
doSecond

---

## 动态代理
动态代理是指， **程序在整个运行过程中根本就不存在目标类的代理类，目标对象的代理对象只是由代理生成工具（如代理工厂类）在程序运行时由 JVM 根据反射等机制动态生成的**。代理对象与目标对象的代理关系在程序运行时才确立。

### JDK 动态代理
通过 JDK 的 java.lang.reflect.Proxy 类实现动态代理,会使用其静态方法 newProxyInstance()，依据目标对象、业务接口及业务增强逻辑三者，自动生成一个动态代理对象。

`public static newProxyInstance ( ClassLoader loader, Class<?>[] interfaces,InvocationHandler handler)`

loader：目标类的类加载器，通过目标对象的反射可获取
interfaces：目标类实现的接口数组，通过目标对象的反射可获取
handler：业务增强逻辑，需要再定义。

InvocationHandler 是个接口，其具体介绍如下：

实现了 InvocationHandler 接口的类用于加强目标类的主业务逻辑。这个接口中有一个方法 invoke()，具体加强的代码逻辑就是定义在该方法中的。程序调用主业务逻辑时，会自动调用 invoke()方法。

invoke()方法的介绍如下：

`public Object invoke ( Object proxy, Method method, Object[] args)`

proxy：代表生成的代理对象
method：代表目标方法
args：代表目标方法的参数

由于该方法是由代理对象自动调用的，所以这三个参数的值不用程序员给出。第二个参数为 Method 类对象，该类有一个方法也叫 invoke()，可以调用目标类的目标方法。这两个 invoke()方法，虽然同名，但无关。

`public Object invoke ( Object obj, Object... args)`

obj：表示目标对象
args：表示目标方法参数，就是其上一层 invoke 方法的第三个参数

该方法的作用是：调用执行 obj 对象所属类的方法，这个方法由其调用者 Method 对
象确定。

在代码中，一般的写法为 `method.invoke(target, args);`

其中， method 为上一层 invoke 方法的第二个参数。这样，即可调用了目标类的目标方法。


```
/**
 * 测试类
 */
public class MyTest {
	public static void main(String[] args) {
		final ISomeService target = new SomeServiceImpl();

		// 使用 JDK 的 Proxy 动态代理，要求目标类必须实现接口
		// 因为其底层的执行原理，与静态代理的相同
		ISomeService service = (ISomeService) Proxy.newProxyInstance(
				target.getClass().getClassLoader(),    // 目标类的类加载器
				target.getClass().getInterfaces(),     // 目标类所实现的所有接口
				new InvocationHandler() {              // 匿名内部类
					// proxy：代理对象，method：目标方法，args：目标方法的参数列表
					@Override
					public Object invoke(Object proxy, Method method, Object[] args)
							throws Throwable {
						// 调用目标方法
						Object result = method.invoke(target, args);
						if (result != null) {
							result = ((String) result).toUpperCase();
						}
						return result;
					}
				});
		String result = service.doFirst();
		System.out.println("result = " + result);
		service.doSecond();
	}

}
```
### CGLIB 动态代理
CGLIB(Code Generation Library)是一个开源项目，是一个强大的、高性能的、高质量的代码生成类库。它可以在运行期扩展和增强 Java 类, Spring 用它来实现 AOP 编程。

使用 JDK 的 Proxy 实现代理，要求目标类与代理类实现相同的接口。若目标类不存在接口， 则无法使用该方式实现。但对于**无接口的类**，要为其创建动态代理，就要使用 CGLIB 来实现。

**CGLIB 代理的生成原理是生成目标类的子类，而子类是增强过的，这个子类对象就是代理对象。** 所以， 使用CGLIB 生成动态代理，要求目标类必须能够被继承，即不能是 final 的类。

**需导 jar 包**
#### 目标类不存在接口
创建代理类的工厂：
```
public class MyCglibFactory implements MethodInterceptor {
	
	private SomeService target;

	public MyCglibFactory() {
		target = new SomeService();
	}

	/**
	 * 返回代理对象
	 */
	public SomeService myCglibCreator() {
		// 创建增强器对象
		Enhancer enhancer = new Enhancer();
		// 指定目标类，即父类
		enhancer.setSuperclass(SomeService.class);
		// 设置回调接口对象
		enhancer.setCallback(this);
		//返回指定类的子类(代理对象)
		return (SomeService) enhancer.create();
	}

	// 回调方法
	@Override
	public Object intercept(Object obj, Method method, Object[] args,
			MethodProxy proxy) throws Throwable {
		// 调用目标方法
		Object result = method.invoke(target, args);
		if (result != null) {
			result = ((String) result).toUpperCase();
		}
		return result;
	}
}
```
目标类：
```
public class SomeService {
	public String doFirst() {
		System.out.println("执行doFirst()方法");
		return "abcde";
	}

	public void doSecond() {
		System.out.println("执行doSecond()方法");
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//代理类(工厂创建的目标类的子类)
		SomeService service = new MyCglibFactory().myCglibCreator();
		String result = service.doFirst();
		System.out.println("result = " + result);
		service.doSecond();
	}
}
```
#### 目标类有接口
目标接口：
```
public interface ISomeService {
	//目标方法
	String doFirst();
	void doSecond();
}
```
目标接口实现类:
```
public class SomeServiceImpl implements ISomeService {
	@Override
	public String doFirst() {
		System.out.println("doFirst");
		return "abcd";
	}

	@Override
	public void doSecond() {
		System.out.println("doSecond");
	}
}
```
创建代理类的工厂:
```
public class MyCglibFactory implements MethodInterceptor {

	private ISomeService target;

	public MyCglibFactory() {
		target = new SomeServiceImpl();
	}

	public ISomeService myCglibCreator() {
		// 创建增强器对象
		Enhancer enhancer = new Enhancer();
		// 指定目标类，即父类
		enhancer.setSuperclass(ISomeService.class);
		// 设置回调接口对象
		enhancer.setCallback(this);
		return (ISomeService) enhancer.create();
	}

	// 回调方法
	@Override
	public Object intercept(Object obj, Method method, Object[] args,MethodProxy proxy) throws Throwable {
		// 调用目标方法
		Object result = method.invoke(target, args);
		if (result != null) {
			result = ((String) result).toUpperCase();
		}
		return result;
	}
}
```
测试类:
```
public class MyTest {
	public static void main(String[] args) {
		//代理类(工厂创建的目标类的子类)
		ISomeService service = new MyCglibFactory().myCglibCreator();
		String result = service.doFirst();
		System.out.println("result = " + result);
		service.doSecond();
	}
}
```',
  'groups' => 'DesignPattern',
  'showsel' => '0',
  'showse2' => '1',
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->updateNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000636s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001434s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000505s ]
[ sql ] [ SQL ] SELECT `groups` FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000309s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000901s ]
[ sql ] [ SQL ] SELECT `parent_id` FROM `groups` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.000361s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `id` = 2 LIMIT 1 [ RunTime:0.000286s ]
[ sql ] [ SQL ] UPDATE `note`  SET `id`=237,`p_id`=2,`title`='代理模式\r',`content`='# 代理模式\r\n[TOC]\r\n\r\n客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。\r\n\r\n>以生活中的“代理律师”为例来理解“代理模式”\r\n\r\n打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。\r\n\r\n聘请代理律师时以下几点需要特别说明：\r\n（1）当事人与代理律师是在为同一件事情努力。\r\n（2）法院所有的具体事务都是通过代理律师完成。\r\n（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。\r\n\r\n对于代理模式，需要注意以下几点：\r\n（1）**代理类和目标类要实现同一个接口**，即业务接口。\r\n（2）**客户类对目标类的调用均是通过代理类完成的**。\r\n（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。\r\n\r\n**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**\r\n## 静态代理\r\n静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。\r\n\r\n静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。\r\n\r\n### Demo\r\n>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD\r\n\r\n目标接口：\r\n```\r\n/**\r\n * 目标接口\r\n */\r\npublic interface ISomeService {\r\n	//目标方法\r\n	String doFirst();\r\n	void doSecond();\r\n}\r\n```\r\n目标实现类:\r\n```\r\n/**\r\n * 目标实现类\r\n */\r\npublic class SomeServiceImpl implements ISomeService {\r\n	@Override\r\n	public String doFirst() {\r\n		System.out.println(\"doFirst\");\r\n		return \"abcd\";\r\n	}\r\n\r\n	@Override\r\n	public void doSecond() {\r\n		System.out.println(\"doSecond\");\r\n	}\r\n}\r\n```\r\n代理类:\r\n```\r\n/**\r\n * 代理类\r\n */\r\npublic class SomeServiceProxy implements ISomeService {\r\n\r\n	//目标对象\r\n	SomeServiceImpl target;\r\n\r\n	public SomeServiceProxy(){\r\n		super();\r\n		//创建目标对象\r\n		target = new SomeServiceImpl();\r\n\r\n	}\r\n\r\n	@Override\r\n	public String doFirst() {\r\n		//代理类调用目标方法\r\n		String result = target.doFirst();\r\n		//增强就发生在这里\r\n		return result.toUpperCase();\r\n	}\r\n\r\n	@Override\r\n	public void doSecond() {\r\n		target.doSecond();\r\n	}\r\n}\r\n```\r\n测试：\r\n```\r\npublic class MyTest {\r\n	public static void main(String[] args) {\r\n		//利用代理对象执行方法\r\n		SomeServiceProxy someServiceProxy = new SomeServiceProxy();\r\n		String result = someServiceProxy.doFirst();\r\n		System.out.println(\"result = \" + result );\r\n		someServiceProxy.doSecond();\r\n	}\r\n}\r\n```\r\n---\r\ndoFirst\r\nresult = ABCD\r\ndoSecond\r\n\r\n---\r\n\r\n## 动态代理\r\n动态代理是指， **程序在整个运行过程中根本就不存在目标类的代理类，目标对象的代理对象只是由代理生成工具（如代理工厂类）在程序运行时由 JVM 根据反射等机制动态生成的**。代理对象与目标对象的代理关系在程序运行时才确立。\r\n\r\n### JDK 动态代理\r\n通过 JDK 的 java.lang.reflect.Proxy 类实现动态代理,会使用其静态方法 newProxyInstance()，依据目标对象、业务接口及业务增强逻辑三者，自动生成一个动态代理对象。\r\n\r\n`public static newProxyInstance ( ClassLoader loader, Class<?>[] interfaces,InvocationHandler handler)`\r\n\r\nloader：目标类的类加载器，通过目标对象的反射可获取\r\ninterfaces：目标类实现的接口数组，通过目标对象的反射可获取\r\nhandler：业务增强逻辑，需要再定义。\r\n\r\nInvocationHandler 是个接口，其具体介绍如下：\r\n\r\n实现了 InvocationHandler 接口的类用于加强目标类的主业务逻辑。这个接口中有一个方法 invoke()，具体加强的代码逻辑就是定义在该方法中的。程序调用主业务逻辑时，会自动调用 invoke()方法。\r\n\r\ninvoke()方法的介绍如下：\r\n\r\n`public Object invoke ( Object proxy, Method method, Object[] args)`\r\n\r\nproxy：代表生成的代理对象\r\nmethod：代表目标方法\r\nargs：代表目标方法的参数\r\n\r\n由于该方法是由代理对象自动调用的，所以这三个参数的值不用程序员给出。第二个参数为 Method 类对象，该类有一个方法也叫 invoke()，可以调用目标类的目标方法。这两个 invoke()方法，虽然同名，但无关。\r\n\r\n`public Object invoke ( Object obj, Object... args)`\r\n\r\nobj：表示目标对象\r\nargs：表示目标方法参数，就是其上一层 invoke 方法的第三个参数\r\n\r\n该方法的作用是：调用执行 obj 对象所属类的方法，这个方法由其调用者 Method 对\r\n象确定。\r\n\r\n在代码中，一般的写法为 `method.invoke(target, args);`\r\n\r\n其中， method 为上一层 invoke 方法的第二个参数。这样，即可调用了目标类的目标方法。\r\n\r\n\r\n```\r\n/**\r\n * 测试类\r\n */\r\npublic class MyTest {\r\n	public static void main(String[] args) {\r\n		final ISomeService target = new SomeServiceImpl();\r\n\r\n		// 使用 JDK 的 Proxy 动态代理，要求目标类必须实现接口\r\n		// 因为其底层的执行原理，与静态代理的相同\r\n		ISomeService service = (ISomeService) Proxy.newProxyInstance(\r\n				target.getClass().getClassLoader(),    // 目标类的类加载器\r\n				target.getClass().getInterfaces(),     // 目标类所实现的所有接口\r\n				new InvocationHandler() {              // 匿名内部类\r\n					// proxy：代理对象，method：目标方法，args：目标方法的参数列表\r\n					@Override\r\n					public Object invoke(Object proxy, Method method, Object[] args)\r\n							throws Throwable {\r\n						// 调用目标方法\r\n						Object result = method.invoke(target, args);\r\n						if (result != null) {\r\n							result = ((String) result).toUpperCase();\r\n						}\r\n						return result;\r\n					}\r\n				});\r\n		String result = service.doFirst();\r\n		System.out.println(\"result = \" + result);\r\n		service.doSecond();\r\n	}\r\n\r\n}\r\n```\r\n### CGLIB 动态代理\r\nCGLIB(Code Generation Library)是一个开源项目，是一个强大的、高性能的、高质量的代码生成类库。它可以在运行期扩展和增强 Java 类, Spring 用它来实现 AOP 编程。\r\n\r\n使用 JDK 的 Proxy 实现代理，要求目标类与代理类实现相同的接口。若目标类不存在接口， 则无法使用该方式实现。但对于**无接口的类**，要为其创建动态代理，就要使用 CGLIB 来实现。\r\n\r\n**CGLIB 代理的生成原理是生成目标类的子类，而子类是增强过的，这个子类对象就是代理对象。** 所以， 使用CGLIB 生成动态代理，要求目标类必须能够被继承，即不能是 final 的类。\r\n\r\n**需导 jar 包**\r\n#### 目标类不存在接口\r\n创建代理类的工厂：\r\n```\r\npublic class MyCglibFactory implements MethodInterceptor {\r\n	\r\n	private SomeService target;\r\n\r\n	public MyCglibFactory() {\r\n		target = new SomeService();\r\n	}\r\n\r\n	/**\r\n	 * 返回代理对象\r\n	 */\r\n	public SomeService myCglibCreator() {\r\n		// 创建增强器对象\r\n		Enhancer enhancer = new Enhancer();\r\n		// 指定目标类，即父类\r\n		enhancer.setSuperclass(SomeService.class);\r\n		// 设置回调接口对象\r\n		enhancer.setCallback(this);\r\n		//返回指定类的子类(代理对象)\r\n		return (SomeService) enhancer.create();\r\n	}\r\n\r\n	// 回调方法\r\n	@Override\r\n	public Object intercept(Object obj, Method method, Object[] args,\r\n			MethodProxy proxy) throws Throwable {\r\n		// 调用目标方法\r\n		Object result = method.invoke(target, args);\r\n		if (result != null) {\r\n			result = ((String) result).toUpperCase();\r\n		}\r\n		return result;\r\n	}\r\n}\r\n```\r\n目标类：\r\n```\r\npublic class SomeService {\r\n	public String doFirst() {\r\n		System.out.println(\"执行doFirst()方法\");\r\n		return \"abcde\";\r\n	}\r\n\r\n	public void doSecond() {\r\n		System.out.println(\"执行doSecond()方法\");\r\n	}\r\n}\r\n```\r\n测试：\r\n```\r\npublic class MyTest {\r\n	public static void main(String[] args) {\r\n		//代理类(工厂创建的目标类的子类)\r\n		SomeService service = new MyCglibFactory().myCglibCreator();\r\n		String result = service.doFirst();\r\n		System.out.println(\"result = \" + result);\r\n		service.doSecond();\r\n	}\r\n}\r\n```\r\n#### 目标类有接口\r\n目标接口：\r\n```\r\npublic interface ISomeService {\r\n	//目标方法\r\n	String doFirst();\r\n	void doSecond();\r\n}\r\n```\r\n目标接口实现类:\r\n```\r\npublic class SomeServiceImpl implements ISomeService {\r\n	@Override\r\n	public String doFirst() {\r\n		System.out.println(\"doFirst\");\r\n		return \"abcd\";\r\n	}\r\n\r\n	@Override\r\n	public void doSecond() {\r\n		System.out.println(\"doSecond\");\r\n	}\r\n}\r\n```\r\n创建代理类的工厂:\r\n```\r\npublic class MyCglibFactory implements MethodInterceptor {\r\n\r\n	private ISomeService target;\r\n\r\n	public MyCglibFactory() {\r\n		target = new SomeServiceImpl();\r\n	}\r\n\r\n	public ISomeService myCglibCreator() {\r\n		// 创建增强器对象\r\n		Enhancer enhancer = new Enhancer();\r\n		// 指定目标类，即父类\r\n		enhancer.setSuperclass(ISomeService.class);\r\n		// 设置回调接口对象\r\n		enhancer.setCallback(this);\r\n		return (ISomeService) enhancer.create();\r\n	}\r\n\r\n	// 回调方法\r\n	@Override\r\n	public Object intercept(Object obj, Method method, Object[] args,MethodProxy proxy) throws Throwable {\r\n		// 调用目标方法\r\n		Object result = method.invoke(target, args);\r\n		if (result != null) {\r\n			result = ((String) result).toUpperCase();\r\n		}\r\n		return result;\r\n	}\r\n}\r\n```\r\n测试类:\r\n```\r\npublic class MyTest {\r\n	public static void main(String[] args) {\r\n		//代理类(工厂创建的目标类的子类)\r\n		ISomeService service = new MyCglibFactory().myCglibCreator();\r\n		String result = service.doFirst();\r\n		System.out.println(\"result = \" + result);\r\n		service.doSecond();\r\n	}\r\n}\r\n```',`groups`='DesignPattern',`is_show`=0,`publish`=1,`summary`=''  WHERE  `id` = 237 [ RunTime:0.000700s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.001890s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=2  WHERE  `groups` = 'DesignPattern' [ RunTime:0.000353s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.001415s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=2  WHERE  `groups` = 'DesignPattern' [ RunTime:0.000353s ]
---------------------------------------------------------------
[ 2018-11-01T22:13:45+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/237.html
[ info ] qingrang.top/daily/admin/note/shownote/id/237.html [运行时间：0.057777s][吞吐率：17.31req/s] [内存消耗：1,989.74kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000562s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001391s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000482s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001019s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000282s ]
---------------------------------------------------------------
[ 2018-11-01T22:14:06+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.074283s][吞吐率：13.46req/s] [内存消耗：2,202.35kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'purpose' => 'prefetch',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000758s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001368s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.001898s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000515s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.001302s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000310s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000410s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000899s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000514s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000577s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000287s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000389s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001512s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000262s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.001088s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.000647s ]
---------------------------------------------------------------
[ 2018-11-01T22:14:07+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.083330s][吞吐率：12.00req/s] [内存消耗：2,202.06kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000633s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001383s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.001907s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000517s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.000918s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000343s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000480s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000888s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000359s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000372s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000330s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000417s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001312s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000225s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.001167s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.000651s ]
---------------------------------------------------------------
[ 2018-11-01T22:14:10+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/newedit.html
[ info ] qingrang.top/daily/admin/note/newedit.html [运行时间：0.058609s][吞吐率：17.06req/s] [内存消耗：2,020.98kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'newedit',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->newEdit[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/newedit.html [ array (
  0 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000567s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001259s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000346s ]
---------------------------------------------------------------
[ 2018-11-01T22:14:18+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/addnote.html
[ info ] qingrang.top/daily/admin/note/addnote.html [运行时间：0.059375s][吞吐率：16.84req/s] [内存消耗：1,976.57kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'addnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '382',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/newedit.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'groups' => 'DesignPattern',
  'content' => '# 适配器模式',
  'test-editormd-html-code' => '<h1 id="h1-u9002u914Du5668u6A21u5F0F"><a name="适配器模式" class="reference-link"></a><span class="header-link octicon octicon-link"></span>适配器模式</h1>',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->addNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000614s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001329s ]
[ sql ] [ SQL ] SELECT `parent_id` FROM `groups` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.000366s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `id` = 2 LIMIT 1 [ RunTime:0.000335s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001109s ]
[ sql ] [ SQL ] INSERT INTO `note` (`title` , `content` , `groups` , `p_id` , `date`) VALUES ('适配器模式' , '# 适配器模式' , 'DesignPattern' , 2 , '2018-11-01') [ RunTime:0.000498s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.001232s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=3  WHERE  `groups` = 'DesignPattern' [ RunTime:0.000442s ]
---------------------------------------------------------------
[ 2018-11-01T22:14:19+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.076021s][吞吐率：13.15req/s] [内存消耗：2,197.73kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/newedit.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000696s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001739s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.001482s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000513s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.000914s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000352s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000494s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000832s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000270s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000442s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000281s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000555s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001105s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000258s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.001262s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.000762s ]
---------------------------------------------------------------
[ 2018-11-01T22:15:08+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/237.html
[ info ] qingrang.top/daily/admin/note/shownote/id/237.html [运行时间：0.069213s][吞吐率：14.45req/s] [内存消耗：1,989.48kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000567s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001380s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000542s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001216s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000308s ]
---------------------------------------------------------------
[ 2018-11-01T22:19:31+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/asearch.html
[ info ] qingrang.top/daily/admin/note/asearch.html [运行时间：0.059584s][吞吐率：16.78req/s] [内存消耗：2,387.71kb] [文件加载：52]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'asearch',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '7',
  'accept' => 'application/json, text/javascript, */*; q=0.01',
  'origin' => 'http://qingrang.top',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'key' => 'git',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->aSearch[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000549s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001284s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  ( `title` LIKE '%git%' OR `content` LIKE '%git%' ) ORDER BY date desc [ RunTime:0.007966s ]
---------------------------------------------------------------
[ 2018-11-01T22:19:40+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/127
[ info ] qingrang.top/daily/admin/note/shownote/id/127 [运行时间：0.081521s][吞吐率：12.27req/s] [内存消耗：1,979.96kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '127',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000656s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001995s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 127 LIMIT 1 [ RunTime:0.000772s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001516s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000469s ]
---------------------------------------------------------------
[ 2018-11-01T22:26:45+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/editnote/id/237.html
[ info ] qingrang.top/daily/admin/note/editnote/id/237.html [运行时间：0.094012s][吞吐率：10.64req/s] [内存消耗：2,053.37kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'editnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->editNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/editnote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000781s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001892s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000768s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001243s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000422s ]
---------------------------------------------------------------
[ 2018-11-01T22:27:25+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/updatenote/id/237.html
[ info ] qingrang.top/daily/admin/note/updatenote/id/237.html [运行时间：0.074552s][吞吐率：13.41req/s] [内存消耗：2,122.11kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'updatenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '23343',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'summary' => '',
  'content' => '# 代理模式
[TOC]

## github
https://github.com/SSGamble/ProxyPattern.git

客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。

>以生活中的“代理律师”为例来理解“代理模式”

打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。

聘请代理律师时以下几点需要特别说明：
（1）当事人与代理律师是在为同一件事情努力。
（2）法院所有的具体事务都是通过代理律师完成。
（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。

对于代理模式，需要注意以下几点：
（1）**代理类和目标类要实现同一个接口**，即业务接口。
（2）**客户类对目标类的调用均是通过代理类完成的**。
（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。

**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**
## 静态代理
静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。

静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。

### Demo
>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD

目标接口：
```
/**
 * 目标接口
 */
public interface ISomeService {
	//目标方法
	String doFirst();
	void doSecond();
}
```
目标实现类:
```
/**
 * 目标实现类
 */
public class SomeServiceImpl implements ISomeService {
	@Override
	public String doFirst() {
		System.out.println("doFirst");
		return "abcd";
	}

	@Override
	public void doSecond() {
		System.out.println("doSecond");
	}
}
```
代理类:
```
/**
 * 代理类
 */
public class SomeServiceProxy implements ISomeService {

	//目标对象
	SomeServiceImpl target;

	public SomeServiceProxy(){
		super();
		//创建目标对象
		target = new SomeServiceImpl();

	}

	@Override
	public String doFirst() {
		//代理类调用目标方法
		String result = target.doFirst();
		//增强就发生在这里
		return result.toUpperCase();
	}

	@Override
	public void doSecond() {
		target.doSecond();
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//利用代理对象执行方法
		SomeServiceProxy someServiceProxy = new SomeServiceProxy();
		String result = someServiceProxy.doFirst();
		System.out.println("result = " + result );
		someServiceProxy.doSecond();
	}
}
```
---
doFirst
result = ABCD
doSecond

---

## 动态代理
动态代理是指， **程序在整个运行过程中根本就不存在目标类的代理类，目标对象的代理对象只是由代理生成工具（如代理工厂类）在程序运行时由 JVM 根据反射等机制动态生成的**。代理对象与目标对象的代理关系在程序运行时才确立。

### JDK 动态代理
通过 JDK 的 java.lang.reflect.Proxy 类实现动态代理,会使用其静态方法 newProxyInstance()，依据目标对象、业务接口及业务增强逻辑三者，自动生成一个动态代理对象。

`public static newProxyInstance ( ClassLoader loader, Class<?>[] interfaces,InvocationHandler handler)`

loader：目标类的类加载器，通过目标对象的反射可获取
interfaces：目标类实现的接口数组，通过目标对象的反射可获取
handler：业务增强逻辑，需要再定义。

InvocationHandler 是个接口，其具体介绍如下：

实现了 InvocationHandler 接口的类用于加强目标类的主业务逻辑。这个接口中有一个方法 invoke()，具体加强的代码逻辑就是定义在该方法中的。程序调用主业务逻辑时，会自动调用 invoke()方法。

invoke()方法的介绍如下：

`public Object invoke ( Object proxy, Method method, Object[] args)`

proxy：代表生成的代理对象
method：代表目标方法
args：代表目标方法的参数

由于该方法是由代理对象自动调用的，所以这三个参数的值不用程序员给出。第二个参数为 Method 类对象，该类有一个方法也叫 invoke()，可以调用目标类的目标方法。这两个 invoke()方法，虽然同名，但无关。

`public Object invoke ( Object obj, Object... args)`

obj：表示目标对象
args：表示目标方法参数，就是其上一层 invoke 方法的第三个参数

该方法的作用是：调用执行 obj 对象所属类的方法，这个方法由其调用者 Method 对
象确定。

在代码中，一般的写法为 `method.invoke(target, args);`

其中， method 为上一层 invoke 方法的第二个参数。这样，即可调用了目标类的目标方法。


```
/**
 * 测试类
 */
public class MyTest {
	public static void main(String[] args) {
		final ISomeService target = new SomeServiceImpl();

		// 使用 JDK 的 Proxy 动态代理，要求目标类必须实现接口
		// 因为其底层的执行原理，与静态代理的相同
		ISomeService service = (ISomeService) Proxy.newProxyInstance(
				target.getClass().getClassLoader(),    // 目标类的类加载器
				target.getClass().getInterfaces(),     // 目标类所实现的所有接口
				new InvocationHandler() {              // 匿名内部类
					// proxy：代理对象，method：目标方法，args：目标方法的参数列表
					@Override
					public Object invoke(Object proxy, Method method, Object[] args)
							throws Throwable {
						// 调用目标方法
						Object result = method.invoke(target, args);
						if (result != null) {
							result = ((String) result).toUpperCase();
						}
						return result;
					}
				});
		String result = service.doFirst();
		System.out.println("result = " + result);
		service.doSecond();
	}

}
```
### CGLIB 动态代理
CGLIB(Code Generation Library)是一个开源项目，是一个强大的、高性能的、高质量的代码生成类库。它可以在运行期扩展和增强 Java 类, Spring 用它来实现 AOP 编程。

使用 JDK 的 Proxy 实现代理，要求目标类与代理类实现相同的接口。若目标类不存在接口， 则无法使用该方式实现。但对于**无接口的类**，要为其创建动态代理，就要使用 CGLIB 来实现。

**CGLIB 代理的生成原理是生成目标类的子类，而子类是增强过的，这个子类对象就是代理对象。** 所以， 使用CGLIB 生成动态代理，要求目标类必须能够被继承，即不能是 final 的类。

**需导 jar 包**
#### 目标类不存在接口
创建代理类的工厂：
```
public class MyCglibFactory implements MethodInterceptor {
	
	private SomeService target;

	public MyCglibFactory() {
		target = new SomeService();
	}

	/**
	 * 返回代理对象
	 */
	public SomeService myCglibCreator() {
		// 创建增强器对象
		Enhancer enhancer = new Enhancer();
		// 指定目标类，即父类
		enhancer.setSuperclass(SomeService.class);
		// 设置回调接口对象
		enhancer.setCallback(this);
		//返回指定类的子类(代理对象)
		return (SomeService) enhancer.create();
	}

	// 回调方法
	@Override
	public Object intercept(Object obj, Method method, Object[] args,
			MethodProxy proxy) throws Throwable {
		// 调用目标方法
		Object result = method.invoke(target, args);
		if (result != null) {
			result = ((String) result).toUpperCase();
		}
		return result;
	}
}
```
目标类：
```
public class SomeService {
	public String doFirst() {
		System.out.println("执行doFirst()方法");
		return "abcde";
	}

	public void doSecond() {
		System.out.println("执行doSecond()方法");
	}
}
```
测试：
```
public class MyTest {
	public static void main(String[] args) {
		//代理类(工厂创建的目标类的子类)
		SomeService service = new MyCglibFactory().myCglibCreator();
		String result = service.doFirst();
		System.out.println("result = " + result);
		service.doSecond();
	}
}
```
#### 目标类有接口
目标接口：
```
public interface ISomeService {
	//目标方法
	String doFirst();
	void doSecond();
}
```
目标接口实现类:
```
public class SomeServiceImpl implements ISomeService {
	@Override
	public String doFirst() {
		System.out.println("doFirst");
		return "abcd";
	}

	@Override
	public void doSecond() {
		System.out.println("doSecond");
	}
}
```
创建代理类的工厂:
```
public class MyCglibFactory implements MethodInterceptor {

	private ISomeService target;

	public MyCglibFactory() {
		target = new SomeServiceImpl();
	}

	public ISomeService myCglibCreator() {
		// 创建增强器对象
		Enhancer enhancer = new Enhancer();
		// 指定目标类，即父类
		enhancer.setSuperclass(ISomeService.class);
		// 设置回调接口对象
		enhancer.setCallback(this);
		return (ISomeService) enhancer.create();
	}

	// 回调方法
	@Override
	public Object intercept(Object obj, Method method, Object[] args,MethodProxy proxy) throws Throwable {
		// 调用目标方法
		Object result = method.invoke(target, args);
		if (result != null) {
			result = ((String) result).toUpperCase();
		}
		return result;
	}
}
```
测试类:
```
public class MyTest {
	public static void main(String[] args) {
		//代理类(工厂创建的目标类的子类)
		ISomeService service = new MyCglibFactory().myCglibCreator();
		String result = service.doFirst();
		System.out.println("result = " + result);
		service.doSecond();
	}
}
```',
  'groups' => 'DesignPattern',
  'showsel' => '0',
  'showse2' => '1',
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->updateNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000591s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001346s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000468s ]
[ sql ] [ SQL ] SELECT `groups` FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000355s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001016s ]
[ sql ] [ SQL ] SELECT `parent_id` FROM `groups` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.000340s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `id` = 2 LIMIT 1 [ RunTime:0.000290s ]
[ sql ] [ SQL ] UPDATE `note`  SET `id`=237,`p_id`=2,`title`='代理模式\r',`content`='# 代理模式\r\n[TOC]\r\n\r\n## github\r\nhttps://github.com/SSGamble/ProxyPattern.git\r\n\r\n客户类真正的想要访问的对象是目标对象，但客户类真正可以访问的对象是代理对象。客户类对目标对象的访问是通过访问代理对象来实现的。当然，代理类与目标类要实现同一个接口。\r\n\r\n>以生活中的“代理律师”为例来理解“代理模式”\r\n\r\n打官司是件非常麻烦的过程，但打官司的人只关心法宣判结果。此时，打官司的人就可聘请“代理律师”来完成整个打官司的所有事务。当事人只需与代理律师签订了协议，那么整个打官司的过程，当事人均可不出现。\r\n\r\n聘请代理律师时以下几点需要特别说明：\r\n（1）当事人与代理律师是在为同一件事情努力。\r\n（2）法院所有的具体事务都是通过代理律师完成。\r\n（3）在法院需要当事人完成某些工作时，代理律师会通知当事人，并为其出谋划策，即增强当事人。\r\n\r\n对于代理模式，需要注意以下几点：\r\n（1）**代理类和目标类要实现同一个接口**，即业务接口。\r\n（2）**客户类对目标类的调用均是通过代理类完成的**。\r\n（3）代理类的执行既执行了对目标类的增强业务逻辑，又调用了目标类的主业务逻辑。\r\n\r\n**使用代理对象，是为了在不修改目标对象的基础上，增强主业务逻辑。**\r\n## 静态代理\r\n静态代理是指，**代理类在程序运行前就已经定义好**，其与目标类的关系在程序运行前就已经确立。\r\n\r\n静态代理类似于企业与企业的法律顾问间的关系。法律顾问与企业的代理关系，并不是在“官司”发生后才建立的，而是之前就确立好的一种关系。\r\n\r\n### Demo\r\n>原目标方法输出 abcd，使用代理增强(不改变原目标)，最终输出 ABCD\r\n\r\n目标接口：\r\n```\r\n/**\r\n * 目标接口\r\n */\r\npublic interface ISomeService {\r\n	//目标方法\r\n	String doFirst();\r\n	void doSecond();\r\n}\r\n```\r\n目标实现类:\r\n```\r\n/**\r\n * 目标实现类\r\n */\r\npublic class SomeServiceImpl implements ISomeService {\r\n	@Override\r\n	public String doFirst() {\r\n		System.out.println(\"doFirst\");\r\n		return \"abcd\";\r\n	}\r\n\r\n	@Override\r\n	public void doSecond() {\r\n		System.out.println(\"doSecond\");\r\n	}\r\n}\r\n```\r\n代理类:\r\n```\r\n/**\r\n * 代理类\r\n */\r\npublic class SomeServiceProxy implements ISomeService {\r\n\r\n	//目标对象\r\n	SomeServiceImpl target;\r\n\r\n	public SomeServiceProxy(){\r\n		super();\r\n		//创建目标对象\r\n		target = new SomeServiceImpl();\r\n\r\n	}\r\n\r\n	@Override\r\n	public String doFirst() {\r\n		//代理类调用目标方法\r\n		String result = target.doFirst();\r\n		//增强就发生在这里\r\n		return result.toUpperCase();\r\n	}\r\n\r\n	@Override\r\n	public void doSecond() {\r\n		target.doSecond();\r\n	}\r\n}\r\n```\r\n测试：\r\n```\r\npublic class MyTest {\r\n	public static void main(String[] args) {\r\n		//利用代理对象执行方法\r\n		SomeServiceProxy someServiceProxy = new SomeServiceProxy();\r\n		String result = someServiceProxy.doFirst();\r\n		System.out.println(\"result = \" + result );\r\n		someServiceProxy.doSecond();\r\n	}\r\n}\r\n```\r\n---\r\ndoFirst\r\nresult = ABCD\r\ndoSecond\r\n\r\n---\r\n\r\n## 动态代理\r\n动态代理是指， **程序在整个运行过程中根本就不存在目标类的代理类，目标对象的代理对象只是由代理生成工具（如代理工厂类）在程序运行时由 JVM 根据反射等机制动态生成的**。代理对象与目标对象的代理关系在程序运行时才确立。\r\n\r\n### JDK 动态代理\r\n通过 JDK 的 java.lang.reflect.Proxy 类实现动态代理,会使用其静态方法 newProxyInstance()，依据目标对象、业务接口及业务增强逻辑三者，自动生成一个动态代理对象。\r\n\r\n`public static newProxyInstance ( ClassLoader loader, Class<?>[] interfaces,InvocationHandler handler)`\r\n\r\nloader：目标类的类加载器，通过目标对象的反射可获取\r\ninterfaces：目标类实现的接口数组，通过目标对象的反射可获取\r\nhandler：业务增强逻辑，需要再定义。\r\n\r\nInvocationHandler 是个接口，其具体介绍如下：\r\n\r\n实现了 InvocationHandler 接口的类用于加强目标类的主业务逻辑。这个接口中有一个方法 invoke()，具体加强的代码逻辑就是定义在该方法中的。程序调用主业务逻辑时，会自动调用 invoke()方法。\r\n\r\ninvoke()方法的介绍如下：\r\n\r\n`public Object invoke ( Object proxy, Method method, Object[] args)`\r\n\r\nproxy：代表生成的代理对象\r\nmethod：代表目标方法\r\nargs：代表目标方法的参数\r\n\r\n由于该方法是由代理对象自动调用的，所以这三个参数的值不用程序员给出。第二个参数为 Method 类对象，该类有一个方法也叫 invoke()，可以调用目标类的目标方法。这两个 invoke()方法，虽然同名，但无关。\r\n\r\n`public Object invoke ( Object obj, Object... args)`\r\n\r\nobj：表示目标对象\r\nargs：表示目标方法参数，就是其上一层 invoke 方法的第三个参数\r\n\r\n该方法的作用是：调用执行 obj 对象所属类的方法，这个方法由其调用者 Method 对\r\n象确定。\r\n\r\n在代码中，一般的写法为 `method.invoke(target, args);`\r\n\r\n其中， method 为上一层 invoke 方法的第二个参数。这样，即可调用了目标类的目标方法。\r\n\r\n\r\n```\r\n/**\r\n * 测试类\r\n */\r\npublic class MyTest {\r\n	public static void main(String[] args) {\r\n		final ISomeService target = new SomeServiceImpl();\r\n\r\n		// 使用 JDK 的 Proxy 动态代理，要求目标类必须实现接口\r\n		// 因为其底层的执行原理，与静态代理的相同\r\n		ISomeService service = (ISomeService) Proxy.newProxyInstance(\r\n				target.getClass().getClassLoader(),    // 目标类的类加载器\r\n				target.getClass().getInterfaces(),     // 目标类所实现的所有接口\r\n				new InvocationHandler() {              // 匿名内部类\r\n					// proxy：代理对象，method：目标方法，args：目标方法的参数列表\r\n					@Override\r\n					public Object invoke(Object proxy, Method method, Object[] args)\r\n							throws Throwable {\r\n						// 调用目标方法\r\n						Object result = method.invoke(target, args);\r\n						if (result != null) {\r\n							result = ((String) result).toUpperCase();\r\n						}\r\n						return result;\r\n					}\r\n				});\r\n		String result = service.doFirst();\r\n		System.out.println(\"result = \" + result);\r\n		service.doSecond();\r\n	}\r\n\r\n}\r\n```\r\n### CGLIB 动态代理\r\nCGLIB(Code Generation Library)是一个开源项目，是一个强大的、高性能的、高质量的代码生成类库。它可以在运行期扩展和增强 Java 类, Spring 用它来实现 AOP 编程。\r\n\r\n使用 JDK 的 Proxy 实现代理，要求目标类与代理类实现相同的接口。若目标类不存在接口， 则无法使用该方式实现。但对于**无接口的类**，要为其创建动态代理，就要使用 CGLIB 来实现。\r\n\r\n**CGLIB 代理的生成原理是生成目标类的子类，而子类是增强过的，这个子类对象就是代理对象。** 所以， 使用CGLIB 生成动态代理，要求目标类必须能够被继承，即不能是 final 的类。\r\n\r\n**需导 jar 包**\r\n#### 目标类不存在接口\r\n创建代理类的工厂：\r\n```\r\npublic class MyCglibFactory implements MethodInterceptor {\r\n	\r\n	private SomeService target;\r\n\r\n	public MyCglibFactory() {\r\n		target = new SomeService();\r\n	}\r\n\r\n	/**\r\n	 * 返回代理对象\r\n	 */\r\n	public SomeService myCglibCreator() {\r\n		// 创建增强器对象\r\n		Enhancer enhancer = new Enhancer();\r\n		// 指定目标类，即父类\r\n		enhancer.setSuperclass(SomeService.class);\r\n		// 设置回调接口对象\r\n		enhancer.setCallback(this);\r\n		//返回指定类的子类(代理对象)\r\n		return (SomeService) enhancer.create();\r\n	}\r\n\r\n	// 回调方法\r\n	@Override\r\n	public Object intercept(Object obj, Method method, Object[] args,\r\n			MethodProxy proxy) throws Throwable {\r\n		// 调用目标方法\r\n		Object result = method.invoke(target, args);\r\n		if (result != null) {\r\n			result = ((String) result).toUpperCase();\r\n		}\r\n		return result;\r\n	}\r\n}\r\n```\r\n目标类：\r\n```\r\npublic class SomeService {\r\n	public String doFirst() {\r\n		System.out.println(\"执行doFirst()方法\");\r\n		return \"abcde\";\r\n	}\r\n\r\n	public void doSecond() {\r\n		System.out.println(\"执行doSecond()方法\");\r\n	}\r\n}\r\n```\r\n测试：\r\n```\r\npublic class MyTest {\r\n	public static void main(String[] args) {\r\n		//代理类(工厂创建的目标类的子类)\r\n		SomeService service = new MyCglibFactory().myCglibCreator();\r\n		String result = service.doFirst();\r\n		System.out.println(\"result = \" + result);\r\n		service.doSecond();\r\n	}\r\n}\r\n```\r\n#### 目标类有接口\r\n目标接口：\r\n```\r\npublic interface ISomeService {\r\n	//目标方法\r\n	String doFirst();\r\n	void doSecond();\r\n}\r\n```\r\n目标接口实现类:\r\n```\r\npublic class SomeServiceImpl implements ISomeService {\r\n	@Override\r\n	public String doFirst() {\r\n		System.out.println(\"doFirst\");\r\n		return \"abcd\";\r\n	}\r\n\r\n	@Override\r\n	public void doSecond() {\r\n		System.out.println(\"doSecond\");\r\n	}\r\n}\r\n```\r\n创建代理类的工厂:\r\n```\r\npublic class MyCglibFactory implements MethodInterceptor {\r\n\r\n	private ISomeService target;\r\n\r\n	public MyCglibFactory() {\r\n		target = new SomeServiceImpl();\r\n	}\r\n\r\n	public ISomeService myCglibCreator() {\r\n		// 创建增强器对象\r\n		Enhancer enhancer = new Enhancer();\r\n		// 指定目标类，即父类\r\n		enhancer.setSuperclass(ISomeService.class);\r\n		// 设置回调接口对象\r\n		enhancer.setCallback(this);\r\n		return (ISomeService) enhancer.create();\r\n	}\r\n\r\n	// 回调方法\r\n	@Override\r\n	public Object intercept(Object obj, Method method, Object[] args,MethodProxy proxy) throws Throwable {\r\n		// 调用目标方法\r\n		Object result = method.invoke(target, args);\r\n		if (result != null) {\r\n			result = ((String) result).toUpperCase();\r\n		}\r\n		return result;\r\n	}\r\n}\r\n```\r\n测试类:\r\n```\r\npublic class MyTest {\r\n	public static void main(String[] args) {\r\n		//代理类(工厂创建的目标类的子类)\r\n		ISomeService service = new MyCglibFactory().myCglibCreator();\r\n		String result = service.doFirst();\r\n		System.out.println(\"result = \" + result);\r\n		service.doSecond();\r\n	}\r\n}\r\n```',`groups`='DesignPattern',`is_show`=0,`publish`=1,`summary`=''  WHERE  `id` = 237 [ RunTime:0.000850s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.001188s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=3  WHERE  `groups` = 'DesignPattern' [ RunTime:0.000349s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.001349s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=3  WHERE  `groups` = 'DesignPattern' [ RunTime:0.000397s ]
---------------------------------------------------------------
[ 2018-11-01T22:27:26+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/237.html
[ info ] qingrang.top/daily/admin/note/shownote/id/237.html [运行时间：0.052186s][吞吐率：19.16req/s] [内存消耗：1,989.81kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/237.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '237',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000540s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001704s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 237 LIMIT 1 [ RunTime:0.000443s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000857s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000276s ]
---------------------------------------------------------------
[ 2018-11-01T22:27:55+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.106713s][吞吐率：9.37req/s] [内存消耗：2,197.14kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000699s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001954s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.003100s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000761s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.001611s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000492s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000714s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001601s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000465s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000612s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000733s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000662s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.002250s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000387s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.002412s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.001276s ]
---------------------------------------------------------------
[ 2018-11-01T22:28:01+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/127
[ info ] qingrang.top/daily/admin/note/shownote/id/127 [运行时间：0.063386s][吞吐率：15.78req/s] [内存消耗：1,980.21kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '127',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000490s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001648s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 127 LIMIT 1 [ RunTime:0.000568s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001001s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000349s ]
---------------------------------------------------------------
[ 2018-11-01T22:28:43+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/
[ info ] qingrang.top/daily/ [运行时间：0.074582s][吞吐率：13.41req/s] [内存消耗：2,121.65kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => '',
    1 => NULL,
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540187497,1540387796,1540648649,1540982738; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ RUN ] app\admin\controller\Show->notelst[ /var/www/html/daily/application/admin/controller/Show.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/show/notelst.html [ array (
  0 => 'list_new',
  1 => 'groups',
  2 => 'groups0',
  3 => 'groups1',
  4 => 'groups2',
  5 => 'groupname',
  6 => 'content',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000589s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001764s ]
[ sql ] [ SQL ] SELECT `content` FROM `note` WHERE  (  id=32 ) LIMIT 1 [ RunTime:0.000555s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 LIMIT 1 [ RunTime:0.001839s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `publish` = 1 ORDER BY id desc LIMIT 0,6 [ RunTime:0.000678s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001305s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `groups` <> 'Personal' [ RunTime:0.000376s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `groups` <> 'Personal'  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000668s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1  AND `groups` <> 'Personal' [ RunTime:0.000342s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000472s ]
---------------------------------------------------------------
[ 2018-11-01T22:29:11+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/delnote/id/238.html
[ info ] qingrang.top/daily/admin/note/delnote/id/238.html [运行时间：0.076881s][吞吐率：13.01req/s] [内存消耗：2,047.63kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'delnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '238',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->delNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000633s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001610s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 238 LIMIT 1 [ RunTime:0.000429s ]
[ sql ] [ SQL ] SELECT `groups` FROM `note` WHERE  `id` = 238 LIMIT 1 [ RunTime:0.000458s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `note_del` [ RunTime:0.001191s ]
[ sql ] [ SQL ] INSERT INTO `note_del` (`id` , `title` , `summary` , `content` , `date` , `groups` , `p_id` , `is_show` , `publish`) VALUES (238 , '适配器模式' , NULL , '# 适配器模式' , '2018-11-01' , 'DesignPattern' , 2 , 0 , 0) [ RunTime:0.000635s ]
[ sql ] [ SQL ] DELETE FROM `note`    WHERE  `id` = 238 [ RunTime:0.000451s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'DesignPattern' LIMIT 1 [ RunTime:0.001302s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001198s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=2  WHERE  `groups` = 'DesignPattern' [ RunTime:0.000391s ]
---------------------------------------------------------------
[ 2018-11-01T22:29:12+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.071697s][吞吐率：13.95req/s] [内存消耗：2,202.54kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000528s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001485s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.001693s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000519s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.000940s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000329s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000603s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001116s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000372s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000417s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000303s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000487s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001100s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000290s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.001118s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.000582s ]
---------------------------------------------------------------
[ 2018-11-01T22:29:29+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note
[ info ] qingrang.top/daily/admin/note [运行时间：0.070577s][吞吐率：14.17req/s] [内存消耗：2,203.01kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => NULL,
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->notelst[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/notelst.html [ array (
  0 => 'stickList',
  1 => 'hide',
  2 => 'list',
  3 => 'list_new',
  4 => 'groups',
  5 => 'groups0',
  6 => 'groups1',
  7 => 'groups2',
  8 => 'count',
  9 => 'year',
  10 => 'default_num',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000541s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001334s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal'  AND `is_show` = 1 ORDER BY date desc,id desc [ RunTime:0.001391s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `groups` <> 'Personal' ORDER BY id desc LIMIT 5 [ RunTime:0.000440s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `config` [ RunTime:0.000977s ]
[ sql ] [ SQL ] SELECT * FROM `config` WHERE  `name` = 'hide' LIMIT 1 [ RunTime:0.000549s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` < 5 [ RunTime:0.000602s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000976s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000349s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 0  AND `id` <> 2 ORDER BY `groups` [ RunTime:0.000594s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `parent_id` = 1 [ RunTime:0.000302s ]
[ sql ] [ SQL ] SELECT * FROM `groups` WHERE  `parent_id` = 2 ORDER BY `groups` [ RunTime:0.000399s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001180s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` LIMIT 1 [ RunTime:0.000256s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `yearlist` [ RunTime:0.001170s ]
[ sql ] [ SQL ] SELECT DISTINCT  `year` FROM `yearlist` ORDER BY year desc [ RunTime:0.000795s ]
---------------------------------------------------------------
[ 2018-11-01T22:30:08+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/editnote/id/233.html
[ info ] qingrang.top/daily/admin/note/editnote/id/233.html [运行时间：0.058846s][吞吐率：16.99req/s] [内存消耗：2,033.07kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'editnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '233',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->editNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/editnote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000477s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001427s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 233 LIMIT 1 [ RunTime:0.000471s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000875s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000373s ]
---------------------------------------------------------------
[ 2018-11-01T22:40:00+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/savenote.html
[ info ] qingrang.top/daily/admin/note/savenote.html [运行时间：0.058788s][吞吐率：17.01req/s] [内存消耗：2,072.77kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'savenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '17462',
  'accept' => 'text/plain, */*; q=0.01',
  'origin' => 'http://qingrang.top',
  'x-requested-with' => 'XMLHttpRequest',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'content-type' => 'application/x-www-form-urlencoded; charset=UTF-8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/233.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'ogroup' => 'Essays',
  'context' => '# 中国史纲
[TOC]
## 中国历史的时空坐标
时间和空间加在一块,才是完整的历史。
### 四个时间坐标点
中国历史发生过几次重要的转型,这些转型推动着中国历史向前的发展。

1.第一个转型,是**商周之变**,就是从商朝到周朝的转型。

这次转型之后,我们开始有了“中国”这个概念,中华文明当中最初的普世主义理想开始出现了。

2.第二个转型,**周秦之变**,就是从周朝到秦朝的转型。

这次转型,让中原从分封割据的局面进入到大一统的局面,中国历史也开始超越于中原之上,中原与草原的相互塑造和对抗开始成为中国历史的大脉络。

3.第三个转型,**唐宋之变**,就是从唐朝到宋朝的转型。

这次转型,让中国的社会结构从豪族社会进入到平民社会,此后中国历史再无长期的分裂,大一统开始成为一个不可逆的历史过程。在先秦之后,中国的文化在宋朝迎来了又一次大爆发,有些西方学者甚至称这是中国的文艺复兴。这次文化爆发,不仅决定了此后将近一千年的中国文化气质,也决定了日本、朝鲜、越南等其他儒教国家的文化气质。

4.第四个转型,就是**清朝末期开始的古今之变**,中国开始从古代社会向现代社会进行艰难转型。

这个过程带来了一系列轰轰烈烈的历史过程,转型过程直到今天仍在继续,还未完成。

### 五个空间坐标点
草原、中原、海洋、西域、高原。

这几个大的空间,彼此之间有着极为深刻的相互依赖相互塑造的关系,以至于脱离开一方就完全解释不了另一方,所以它们加在一块构成一个体系。

## 中国的概念和中华文明的普世主义理想【商周】
### 历史上第一次出现「中国」
周朝的第二位君主周成王,兴建了东都洛阳城,当时有个叫做「何」的贵族,这人铸了一件青铜器纪念这个事儿,1963年这个青铜器在陕西宝鸡被发现,今天称其为「何尊」，「何尊」的底部铸了一百多个字,里面提到,周武王说要"宅兹中国”,就是说要“住在中国”,这是"中国"这个词的最早来源。

什么叫中国？**达到了文明最高水准的地方,就是文明意义上的中心,古人就管这种地方叫做「中国」。**
### 中华文明的普世主义理想：究竟天命是降于周人呢,还是天命降于周王
商朝是由“商人"。他们认为天命降于商人。为了让天能够永远地保佑自己,商人会经常地进行大规模的祭祀活动,祭祀当中会大量用到活人做祭品。

这些被献祭的人从哪来呢?

从对外战争掠夺的羌人而来。所谓的羌人就是生活在商王朝西部的、除了商朝人以外的所有人。

商人的这种天命观,肯定会受到羌人的抵抗。其中,周人是最主要的一支抵抗力量,他们逐渐组织了很多苦不堪言的羌人群体来反抗商朝，反抗的时候,在周人中间有过一个观念层面的争论,究竟天命是降于周人呢,还是天命降于周王?争论的结果是,天命降于周王。

这个观念变化太重要了。初看上去,这似乎是把天命的载体变得狭隘了,实际上是把它变得普世了。

为什么这么说呢?如果天命是降于周人,那就和此前降于商人的路数差不多,周人的岁月要想静好,就得时刻压制住所有不是周人的群体。这样的话,周人和商人征战,谁胜谁败就不好说了。因为,对其他羌人群体来说,打完这一仗,十有八九只不过换了个地方拿我们献祭,凭啥要跟你混啊?而**如果天命是降于周王,则周王便是天下的共主,他不仅仅要为周人主持正义,而是要为全天下人主持正义,这是一种真正的普世主义观念**。

### 什么是封建社会
推翻了商朝之后,周朝又是如何具体建立它的统治方式呢?那就是,分封制。周天子向下分封了他的大量亲戚和重臣,意图依靠他们形成的藩属诸侯国,来拱卫周王。这样一种政治统治形式就被称作“封建”,这种社会叫做封建社会。

封建“这个词最初出自《左传》,里面有句话叫做“封建亲戚,以藩屏周”,就是说分封亲信出去建立诸侯国,作为周朝王室领地的屏障。**只有这种封土建邦、分封割据的状态,才叫做封建。**

封建社会的一大特征是,最高统治者是没有权力干涉诸侯国内部事务的,诸侯们确实是最高统治者的封臣,但某种意义上也像是个合伙人,都有比较强的独立性。

周朝的时候,诸侯都承认周天子是最高权威,但周天子并不能管诸侯国内部的事情。周朝在这个过程中建立了封建社会,但周天子又逐渐衰落了。在周天子衰落之后,历史的主角就变成了那些诸侯。诸侯们彼此不断竞争,最终终结了中国的封建社会。

## 封建社会的终结
到了西周后期,周天子的影响力越来越差,最终被迫迁都洛阳,中国历史进入到东周。东周又分成了舂秋战国两个时期,封建社会也在春秋战国时代走上末日。

末日之路的由来,是因为在春秋战国时期,出现了一个非常关键的变化,就是战争逻辑变了。


春秋战国时期,战争的逻辑发生了深刻的变化,再加上铁器牛耕以及竹简这些新技术的出现,使得平民开始成为君主可以利用的政治力量。

所有这些因素,都导致了贵族所重视的那种"礼"的秩序崩溃,中国历史上的封建秩序就走上了末日。

在春秋战国这样一个血光四射的年代,不仅有激烈的军事竞争,也发生了一系列激烈的思想竞争。这带来了中国历史上罕见的、大规模的思想变革,并在很大程度上奠定了之后两千多年中国人的精神基础。



',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->saveNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000598s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001363s ]
[ sql ] [ SQL ] UPDATE `note`  SET `title`='中国史纲',`content`='# 中国史纲\n[TOC]\n## 中国历史的时空坐标\n时间和空间加在一块,才是完整的历史。\n### 四个时间坐标点\n中国历史发生过几次重要的转型,这些转型推动着中国历史向前的发展。\n\n1.第一个转型,是**商周之变**,就是从商朝到周朝的转型。\n\n这次转型之后,我们开始有了“中国”这个概念,中华文明当中最初的普世主义理想开始出现了。\n\n2.第二个转型,**周秦之变**,就是从周朝到秦朝的转型。\n\n这次转型,让中原从分封割据的局面进入到大一统的局面,中国历史也开始超越于中原之上,中原与草原的相互塑造和对抗开始成为中国历史的大脉络。\n\n3.第三个转型,**唐宋之变**,就是从唐朝到宋朝的转型。\n\n这次转型,让中国的社会结构从豪族社会进入到平民社会,此后中国历史再无长期的分裂,大一统开始成为一个不可逆的历史过程。在先秦之后,中国的文化在宋朝迎来了又一次大爆发,有些西方学者甚至称这是中国的文艺复兴。这次文化爆发,不仅决定了此后将近一千年的中国文化气质,也决定了日本、朝鲜、越南等其他儒教国家的文化气质。\n\n4.第四个转型,就是**清朝末期开始的古今之变**,中国开始从古代社会向现代社会进行艰难转型。\n\n这个过程带来了一系列轰轰烈烈的历史过程,转型过程直到今天仍在继续,还未完成。\n\n### 五个空间坐标点\n草原、中原、海洋、西域、高原。\n\n这几个大的空间,彼此之间有着极为深刻的相互依赖相互塑造的关系,以至于脱离开一方就完全解释不了另一方,所以它们加在一块构成一个体系。\n\n## 中国的概念和中华文明的普世主义理想【商周】\n### 历史上第一次出现「中国」\n周朝的第二位君主周成王,兴建了东都洛阳城,当时有个叫做「何」的贵族,这人铸了一件青铜器纪念这个事儿,1963年这个青铜器在陕西宝鸡被发现,今天称其为「何尊」，「何尊」的底部铸了一百多个字,里面提到,周武王说要\"宅兹中国”,就是说要“住在中国”,这是\"中国\"这个词的最早来源。\n\n什么叫中国？**达到了文明最高水准的地方,就是文明意义上的中心,古人就管这种地方叫做「中国」。**\n### 中华文明的普世主义理想：究竟天命是降于周人呢,还是天命降于周王\n商朝是由“商人\"。他们认为天命降于商人。为了让天能够永远地保佑自己,商人会经常地进行大规模的祭祀活动,祭祀当中会大量用到活人做祭品。\n\n这些被献祭的人从哪来呢?\n\n从对外战争掠夺的羌人而来。所谓的羌人就是生活在商王朝西部的、除了商朝人以外的所有人。\n\n商人的这种天命观,肯定会受到羌人的抵抗。其中,周人是最主要的一支抵抗力量,他们逐渐组织了很多苦不堪言的羌人群体来反抗商朝，反抗的时候,在周人中间有过一个观念层面的争论,究竟天命是降于周人呢,还是天命降于周王?争论的结果是,天命降于周王。\n\n这个观念变化太重要了。初看上去,这似乎是把天命的载体变得狭隘了,实际上是把它变得普世了。\n\n为什么这么说呢?如果天命是降于周人,那就和此前降于商人的路数差不多,周人的岁月要想静好,就得时刻压制住所有不是周人的群体。这样的话,周人和商人征战,谁胜谁败就不好说了。因为,对其他羌人群体来说,打完这一仗,十有八九只不过换了个地方拿我们献祭,凭啥要跟你混啊?而**如果天命是降于周王,则周王便是天下的共主,他不仅仅要为周人主持正义,而是要为全天下人主持正义,这是一种真正的普世主义观念**。\n\n### 什么是封建社会\n推翻了商朝之后,周朝又是如何具体建立它的统治方式呢?那就是,分封制。周天子向下分封了他的大量亲戚和重臣,意图依靠他们形成的藩属诸侯国,来拱卫周王。这样一种政治统治形式就被称作“封建”,这种社会叫做封建社会。\n\n封建“这个词最初出自《左传》,里面有句话叫做“封建亲戚,以藩屏周”,就是说分封亲信出去建立诸侯国,作为周朝王室领地的屏障。**只有这种封土建邦、分封割据的状态,才叫做封建。**\n\n封建社会的一大特征是,最高统治者是没有权力干涉诸侯国内部事务的,诸侯们确实是最高统治者的封臣,但某种意义上也像是个合伙人,都有比较强的独立性。\n\n周朝的时候,诸侯都承认周天子是最高权威,但周天子并不能管诸侯国内部的事情。周朝在这个过程中建立了封建社会,但周天子又逐渐衰落了。在周天子衰落之后,历史的主角就变成了那些诸侯。诸侯们彼此不断竞争,最终终结了中国的封建社会。\n\n## 封建社会的终结\n到了西周后期,周天子的影响力越来越差,最终被迫迁都洛阳,中国历史进入到东周。东周又分成了舂秋战国两个时期,封建社会也在春秋战国时代走上末日。\n\n末日之路的由来,是因为在春秋战国时期,出现了一个非常关键的变化,就是战争逻辑变了。\n\n\n春秋战国时期,战争的逻辑发生了深刻的变化,再加上铁器牛耕以及竹简这些新技术的出现,使得平民开始成为君主可以利用的政治力量。\n\n所有这些因素,都导致了贵族所重视的那种\"礼\"的秩序崩溃,中国历史上的封建秩序就走上了末日。\n\n在春秋战国这样一个血光四射的年代,不仅有激烈的军事竞争,也发生了一系列激烈的思想竞争。这带来了中国历史上罕见的、大规模的思想变革,并在很大程度上奠定了之后两千多年中国人的精神基础。\n\n\n\n',`groups`='Default',`p_id`=1  WHERE  `id` = 1 [ RunTime:0.000815s ]
---------------------------------------------------------------
[ 2018-11-01T23:07:05+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/updatenote/id/233.html
[ info ] qingrang.top/daily/admin/note/updatenote/id/233.html [运行时间：0.078958s][吞吐率：12.66req/s] [内存消耗：2,129.12kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'updatenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '30879',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/233.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'summary' => '',
  'content' => '# 中国史纲
[TOC]
## 中国历史的时空坐标
时间和空间加在一块,才是完整的历史。
### 四个时间坐标点
中国历史发生过几次重要的转型,这些转型推动着中国历史向前的发展。

1.第一个转型,是**商周之变**,就是从商朝到周朝的转型。

这次转型之后,我们开始有了“中国”这个概念,中华文明当中最初的普世主义理想开始出现了。

2.第二个转型,**周秦之变**,就是从周朝到秦朝的转型。

这次转型,让中原从分封割据的局面进入到大一统的局面,中国历史也开始超越于中原之上,中原与草原的相互塑造和对抗开始成为中国历史的大脉络。

3.第三个转型,**唐宋之变**,就是从唐朝到宋朝的转型。

这次转型,让中国的社会结构从豪族社会进入到平民社会,此后中国历史再无长期的分裂,大一统开始成为一个不可逆的历史过程。在先秦之后,中国的文化在宋朝迎来了又一次大爆发,有些西方学者甚至称这是中国的文艺复兴。这次文化爆发,不仅决定了此后将近一千年的中国文化气质,也决定了日本、朝鲜、越南等其他儒教国家的文化气质。

4.第四个转型,就是**清朝末期开始的古今之变**,中国开始从古代社会向现代社会进行艰难转型。

这个过程带来了一系列轰轰烈烈的历史过程,转型过程直到今天仍在继续,还未完成。

### 五个空间坐标点
草原、中原、海洋、西域、高原。

这几个大的空间,彼此之间有着极为深刻的相互依赖相互塑造的关系,以至于脱离开一方就完全解释不了另一方,所以它们加在一块构成一个体系。

## 中国的概念和中华文明的普世主义理想【商周】
### 历史上第一次出现「中国」
周朝的第二位君主周成王,兴建了东都洛阳城,当时有个叫做「何」的贵族,这人铸了一件青铜器纪念这个事儿,1963年这个青铜器在陕西宝鸡被发现,今天称其为「何尊」，「何尊」的底部铸了一百多个字,里面提到,周武王说要"宅兹中国”,就是说要“住在中国”,这是"中国"这个词的最早来源。

什么叫中国？**达到了文明最高水准的地方,就是文明意义上的中心,古人就管这种地方叫做「中国」。**
### 中华文明的普世主义理想：究竟天命是降于周人呢,还是天命降于周王
商朝是由“商人"。他们认为天命降于商人。为了让天能够永远地保佑自己,商人会经常地进行大规模的祭祀活动,祭祀当中会大量用到活人做祭品。

这些被献祭的人从哪来呢?

从对外战争掠夺的羌人而来。所谓的羌人就是生活在商王朝西部的、除了商朝人以外的所有人。

商人的这种天命观,肯定会受到羌人的抵抗。其中,周人是最主要的一支抵抗力量,他们逐渐组织了很多苦不堪言的羌人群体来反抗商朝，反抗的时候,在周人中间有过一个观念层面的争论,究竟天命是降于周人呢,还是天命降于周王?争论的结果是,天命降于周王。

这个观念变化太重要了。初看上去,这似乎是把天命的载体变得狭隘了,实际上是把它变得普世了。

为什么这么说呢?如果天命是降于周人,那就和此前降于商人的路数差不多,周人的岁月要想静好,就得时刻压制住所有不是周人的群体。这样的话,周人和商人征战,谁胜谁败就不好说了。因为,对其他羌人群体来说,打完这一仗,十有八九只不过换了个地方拿我们献祭,凭啥要跟你混啊?而**如果天命是降于周王,则周王便是天下的共主,他不仅仅要为周人主持正义,而是要为全天下人主持正义,这是一种真正的普世主义观念**。

### 什么是封建社会
推翻了商朝之后,周朝又是如何具体建立它的统治方式呢?那就是,分封制。周天子向下分封了他的大量亲戚和重臣,意图依靠他们形成的藩属诸侯国,来拱卫周王。这样一种政治统治形式就被称作“封建”,这种社会叫做封建社会。

封建“这个词最初出自《左传》,里面有句话叫做“封建亲戚,以藩屏周”,就是说分封亲信出去建立诸侯国,作为周朝王室领地的屏障。**只有这种封土建邦、分封割据的状态,才叫做封建。**

封建社会的一大特征是,最高统治者是没有权力干涉诸侯国内部事务的,诸侯们确实是最高统治者的封臣,但某种意义上也像是个合伙人,都有比较强的独立性。

周朝的时候,诸侯都承认周天子是最高权威,但周天子并不能管诸侯国内部的事情。周朝在这个过程中建立了封建社会,但周天子又逐渐衰落了。在周天子衰落之后,历史的主角就变成了那些诸侯。诸侯们彼此不断竞争,最终终结了中国的封建社会。

## 封建社会的终结【春秋末期、战国初期】
到了西周后期,周天子的影响力越来越差,最终被迫迁都洛阳,中国历史进入到东周。

东周又分成了舂秋战国两个时期,春秋末期出现了一些重要的技术发展,它带来了新的经济和人力资源,打破了过去的社会均衡,封建社会当中的贵族秩序崩塌了，封建社会也在春秋战国时代走上末日。

### 战争的逻辑的变化
春秋之前的的战争十分注重礼仪性(战争都是贵族在参与，这就导致了参与人数并不多，他们认为战争是一件高贵的事，他们的战争可能就是比谁的正步踢得好)。但到了春秋中后期,随着楚国(楚国是个土生政权,并不是周天子分封的诸侯国，它的文化和中原有很大区别,也不大在乎中原的礼仪之类的东西,在当时的中原诸侯看来它就是个蛮夷之邦。)的加入，战争变成以砍死人为目的了。也正是由于这个战争逻辑的变化,才把中国引向了大一统。

### 两个技术变迁
诸侯分封次级诸侯，随着次级诸侯势力的增大，诸侯和次级诸侯的关系同周天子和诸侯的关系一样。在春秋末期、战国初期,出现了两个重要的技术变迁,让诸侯力量的扩大有了可能。正是因为这两次技术变革,打破了君主和封臣之间的力量均衡,周厉王当初搞不定自己下级的事,现在诸侯可以做到了,也就是诸侯能够搞定这些次级诸侯。

这两个技术变迁,一个是铁器和牛耕的农业生产技术,一个是竹简这种知识传播技术。

>铁器和牛耕 - 农业生产技术

铁器与牛耕的出现,提升了平民的劳动效率。过去,他们的耕种效率很低,只能在贵族控制的公田、又叫井田上种地,没有能力再去开垦自己的私田了;但是,铁器和牛耕让生产效率大大提升了,平民有余力去开垦自己的私田,甚至索性就从贵族控制的井田上跑路了。此时君主、贵族、平民三者之间的一种复杂博弈关系就出现了。注意,这儿所说的君主,指的就是周天子封的诸侯,贵族指的就是诸侯所封的次级诸侯,这会儿的历史已经没周天子什么事儿了。

君主向耕种私田的平民提供保护,平民向君主交税。平民从井田上越跑越多,贵族所控制的井田制就逐渐瓦解了,贵族的力量也逐渐削弱了。君主开始获得相对于贵族的优势。

>竹简 - 知识传播技术

 知识传播的成本急剧下降,一般的贵族子弟、甚至运气好的普通百姓,都有机会学习文字获得知识了。由于多年的人口膨胀,这个时候出现了很多有文化、却无法获得一块封地的贵族子弟,他们就变成游士,到处寻找把自己卖个好价钱的机会。

君主们早就想养一群可控的自己人了。什么样的人最好用呢?

第一,他们要在本国没有根基,没资本对抗君主;
第二,他们的地位尊荣都取决于君主的赏赐,就有动力与君主相配合。

从别国跑来的游士完全符合这两点要求。君主与游士拍即合,游士成为依附于君主的私人人事班底。这个人事班底,后来就发展为官僚制。

官僚和贵族的区别在于,本质上来说,官僚没有独立性,他们是职业经理人,其地位取决于君主的意志;贵族有独立性,他们是准合伙人,君主有大事必须和他们商量着来。游士的出现,终于让君主们可以全方位碾压贵族封臣,诸侯国也就从君主与贵族共治的结构,转向君主说了算的官僚制结构。

### 变法

这个过程在历史上被叫作什么呢?

变法! 没错,魏国的李悝变法、秦国的商鞅变法等等,就是这样展开的。

来自其他国家的游士,成了各诸侯国的新贵,他们压制住所在国的大贵族,把君主的意志贯彻下去。随着各种变法的展开,中国历史就进入到了战国时代。

对君主来说,这回有办法把平民也动员起来了。你们虽然不是贵族血统,但你们可以立军功。只要你有办法从战场上拎回更多的人头,你也有机会上升到比贵族还高的地位。这种激励可不得了,战争的规模和频次急剧上升,大规模的灭国之战很容易就爆发了。灭国之战都到什么量级呢?比如很多人推崇的战神白起,一场战役就会坑杀赵国的40万降兵,这都在变法之后成为可能，变法这个事情也有传染性,谁最先变法,谁的战争效率就大幅上升;其他国家如果不跟上,就只能等着挨打。

随着各国陆续变法,各诸侯国内部的旧贵族阶层被一扫而空。变法之后,君主能决定军功的标准,也就能决定官僚新贵们的地位高低,君主对国家的控制力就变得更强,再没有能够约束君主的力量,分封割据的封建社会也就逐渐走上了终结之日战争逻辑的变化,影响还不止于此,当战争规模扩大到了诸侯国承受不起的时候,中国也就开始走向大一统。

---
在春秋战国这样一个血光四射的年代,不仅有激烈的军事竞争,也发生了一系列激烈的思想竞争。这带来了中国历史上罕见的、大规模的思想变革,并在很大程度上奠定了之后两千多年中国人的精神基础。



',
  'groups' => 'Default',
  'showsel' => '1',
  'showse2' => '1',
  'id' => '233',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->updateNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000611s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001461s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 233 LIMIT 1 [ RunTime:0.000438s ]
[ sql ] [ SQL ] SELECT `groups` FROM `note` WHERE  `id` = 233 LIMIT 1 [ RunTime:0.000377s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001283s ]
[ sql ] [ SQL ] SELECT `parent_id` FROM `groups` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.000346s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `id` = 0 LIMIT 1 [ RunTime:0.000287s ]
[ sql ] [ SQL ] SELECT `id` FROM `groups` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.000307s ]
[ sql ] [ SQL ] UPDATE `note`  SET `id`=233,`p_id`=1,`title`='中国史纲\r',`content`='# 中国史纲\r\n[TOC]\r\n## 中国历史的时空坐标\r\n时间和空间加在一块,才是完整的历史。\r\n### 四个时间坐标点\r\n中国历史发生过几次重要的转型,这些转型推动着中国历史向前的发展。\r\n\r\n1.第一个转型,是**商周之变**,就是从商朝到周朝的转型。\r\n\r\n这次转型之后,我们开始有了“中国”这个概念,中华文明当中最初的普世主义理想开始出现了。\r\n\r\n2.第二个转型,**周秦之变**,就是从周朝到秦朝的转型。\r\n\r\n这次转型,让中原从分封割据的局面进入到大一统的局面,中国历史也开始超越于中原之上,中原与草原的相互塑造和对抗开始成为中国历史的大脉络。\r\n\r\n3.第三个转型,**唐宋之变**,就是从唐朝到宋朝的转型。\r\n\r\n这次转型,让中国的社会结构从豪族社会进入到平民社会,此后中国历史再无长期的分裂,大一统开始成为一个不可逆的历史过程。在先秦之后,中国的文化在宋朝迎来了又一次大爆发,有些西方学者甚至称这是中国的文艺复兴。这次文化爆发,不仅决定了此后将近一千年的中国文化气质,也决定了日本、朝鲜、越南等其他儒教国家的文化气质。\r\n\r\n4.第四个转型,就是**清朝末期开始的古今之变**,中国开始从古代社会向现代社会进行艰难转型。\r\n\r\n这个过程带来了一系列轰轰烈烈的历史过程,转型过程直到今天仍在继续,还未完成。\r\n\r\n### 五个空间坐标点\r\n草原、中原、海洋、西域、高原。\r\n\r\n这几个大的空间,彼此之间有着极为深刻的相互依赖相互塑造的关系,以至于脱离开一方就完全解释不了另一方,所以它们加在一块构成一个体系。\r\n\r\n## 中国的概念和中华文明的普世主义理想【商周】\r\n### 历史上第一次出现「中国」\r\n周朝的第二位君主周成王,兴建了东都洛阳城,当时有个叫做「何」的贵族,这人铸了一件青铜器纪念这个事儿,1963年这个青铜器在陕西宝鸡被发现,今天称其为「何尊」，「何尊」的底部铸了一百多个字,里面提到,周武王说要\"宅兹中国”,就是说要“住在中国”,这是\"中国\"这个词的最早来源。\r\n\r\n什么叫中国？**达到了文明最高水准的地方,就是文明意义上的中心,古人就管这种地方叫做「中国」。**\r\n### 中华文明的普世主义理想：究竟天命是降于周人呢,还是天命降于周王\r\n商朝是由“商人\"。他们认为天命降于商人。为了让天能够永远地保佑自己,商人会经常地进行大规模的祭祀活动,祭祀当中会大量用到活人做祭品。\r\n\r\n这些被献祭的人从哪来呢?\r\n\r\n从对外战争掠夺的羌人而来。所谓的羌人就是生活在商王朝西部的、除了商朝人以外的所有人。\r\n\r\n商人的这种天命观,肯定会受到羌人的抵抗。其中,周人是最主要的一支抵抗力量,他们逐渐组织了很多苦不堪言的羌人群体来反抗商朝，反抗的时候,在周人中间有过一个观念层面的争论,究竟天命是降于周人呢,还是天命降于周王?争论的结果是,天命降于周王。\r\n\r\n这个观念变化太重要了。初看上去,这似乎是把天命的载体变得狭隘了,实际上是把它变得普世了。\r\n\r\n为什么这么说呢?如果天命是降于周人,那就和此前降于商人的路数差不多,周人的岁月要想静好,就得时刻压制住所有不是周人的群体。这样的话,周人和商人征战,谁胜谁败就不好说了。因为,对其他羌人群体来说,打完这一仗,十有八九只不过换了个地方拿我们献祭,凭啥要跟你混啊?而**如果天命是降于周王,则周王便是天下的共主,他不仅仅要为周人主持正义,而是要为全天下人主持正义,这是一种真正的普世主义观念**。\r\n\r\n### 什么是封建社会\r\n推翻了商朝之后,周朝又是如何具体建立它的统治方式呢?那就是,分封制。周天子向下分封了他的大量亲戚和重臣,意图依靠他们形成的藩属诸侯国,来拱卫周王。这样一种政治统治形式就被称作“封建”,这种社会叫做封建社会。\r\n\r\n封建“这个词最初出自《左传》,里面有句话叫做“封建亲戚,以藩屏周”,就是说分封亲信出去建立诸侯国,作为周朝王室领地的屏障。**只有这种封土建邦、分封割据的状态,才叫做封建。**\r\n\r\n封建社会的一大特征是,最高统治者是没有权力干涉诸侯国内部事务的,诸侯们确实是最高统治者的封臣,但某种意义上也像是个合伙人,都有比较强的独立性。\r\n\r\n周朝的时候,诸侯都承认周天子是最高权威,但周天子并不能管诸侯国内部的事情。周朝在这个过程中建立了封建社会,但周天子又逐渐衰落了。在周天子衰落之后,历史的主角就变成了那些诸侯。诸侯们彼此不断竞争,最终终结了中国的封建社会。\r\n\r\n## 封建社会的终结【春秋末期、战国初期】\r\n到了西周后期,周天子的影响力越来越差,最终被迫迁都洛阳,中国历史进入到东周。\r\n\r\n东周又分成了舂秋战国两个时期,春秋末期出现了一些重要的技术发展,它带来了新的经济和人力资源,打破了过去的社会均衡,封建社会当中的贵族秩序崩塌了，封建社会也在春秋战国时代走上末日。\r\n\r\n### 战争的逻辑的变化\r\n春秋之前的的战争十分注重礼仪性(战争都是贵族在参与，这就导致了参与人数并不多，他们认为战争是一件高贵的事，他们的战争可能就是比谁的正步踢得好)。但到了春秋中后期,随着楚国(楚国是个土生政权,并不是周天子分封的诸侯国，它的文化和中原有很大区别,也不大在乎中原的礼仪之类的东西,在当时的中原诸侯看来它就是个蛮夷之邦。)的加入，战争变成以砍死人为目的了。也正是由于这个战争逻辑的变化,才把中国引向了大一统。\r\n\r\n### 两个技术变迁\r\n诸侯分封次级诸侯，随着次级诸侯势力的增大，诸侯和次级诸侯的关系同周天子和诸侯的关系一样。在春秋末期、战国初期,出现了两个重要的技术变迁,让诸侯力量的扩大有了可能。正是因为这两次技术变革,打破了君主和封臣之间的力量均衡,周厉王当初搞不定自己下级的事,现在诸侯可以做到了,也就是诸侯能够搞定这些次级诸侯。\r\n\r\n这两个技术变迁,一个是铁器和牛耕的农业生产技术,一个是竹简这种知识传播技术。\r\n\r\n>铁器和牛耕 - 农业生产技术\r\n\r\n铁器与牛耕的出现,提升了平民的劳动效率。过去,他们的耕种效率很低,只能在贵族控制的公田、又叫井田上种地,没有能力再去开垦自己的私田了;但是,铁器和牛耕让生产效率大大提升了,平民有余力去开垦自己的私田,甚至索性就从贵族控制的井田上跑路了。此时君主、贵族、平民三者之间的一种复杂博弈关系就出现了。注意,这儿所说的君主,指的就是周天子封的诸侯,贵族指的就是诸侯所封的次级诸侯,这会儿的历史已经没周天子什么事儿了。\r\n\r\n君主向耕种私田的平民提供保护,平民向君主交税。平民从井田上越跑越多,贵族所控制的井田制就逐渐瓦解了,贵族的力量也逐渐削弱了。君主开始获得相对于贵族的优势。\r\n\r\n>竹简 - 知识传播技术\r\n\r\n 知识传播的成本急剧下降,一般的贵族子弟、甚至运气好的普通百姓,都有机会学习文字获得知识了。由于多年的人口膨胀,这个时候出现了很多有文化、却无法获得一块封地的贵族子弟,他们就变成游士,到处寻找把自己卖个好价钱的机会。\r\n\r\n君主们早就想养一群可控的自己人了。什么样的人最好用呢?\r\n\r\n第一,他们要在本国没有根基,没资本对抗君主;\r\n第二,他们的地位尊荣都取决于君主的赏赐,就有动力与君主相配合。\r\n\r\n从别国跑来的游士完全符合这两点要求。君主与游士拍即合,游士成为依附于君主的私人人事班底。这个人事班底,后来就发展为官僚制。\r\n\r\n官僚和贵族的区别在于,本质上来说,官僚没有独立性,他们是职业经理人,其地位取决于君主的意志;贵族有独立性,他们是准合伙人,君主有大事必须和他们商量着来。游士的出现,终于让君主们可以全方位碾压贵族封臣,诸侯国也就从君主与贵族共治的结构,转向君主说了算的官僚制结构。\r\n\r\n### 变法\r\n\r\n这个过程在历史上被叫作什么呢?\r\n\r\n变法! 没错,魏国的李悝变法、秦国的商鞅变法等等,就是这样展开的。\r\n\r\n来自其他国家的游士,成了各诸侯国的新贵,他们压制住所在国的大贵族,把君主的意志贯彻下去。随着各种变法的展开,中国历史就进入到了战国时代。\r\n\r\n对君主来说,这回有办法把平民也动员起来了。你们虽然不是贵族血统,但你们可以立军功。只要你有办法从战场上拎回更多的人头,你也有机会上升到比贵族还高的地位。这种激励可不得了,战争的规模和频次急剧上升,大规模的灭国之战很容易就爆发了。灭国之战都到什么量级呢?比如很多人推崇的战神白起,一场战役就会坑杀赵国的40万降兵,这都在变法之后成为可能，变法这个事情也有传染性,谁最先变法,谁的战争效率就大幅上升;其他国家如果不跟上,就只能等着挨打。\r\n\r\n随着各国陆续变法,各诸侯国内部的旧贵族阶层被一扫而空。变法之后,君主能决定军功的标准,也就能决定官僚新贵们的地位高低,君主对国家的控制力就变得更强,再没有能够约束君主的力量,分封割据的封建社会也就逐渐走上了终结之日战争逻辑的变化,影响还不止于此,当战争规模扩大到了诸侯国承受不起的时候,中国也就开始走向大一统。\r\n\r\n---\r\n在春秋战国这样一个血光四射的年代,不仅有激烈的军事竞争,也发生了一系列激烈的思想竞争。这带来了中国历史上罕见的、大规模的思想变革,并在很大程度上奠定了之后两千多年中国人的精神基础。\r\n\r\n\r\n\r\n',`groups`='Default',`is_show`=1,`publish`=1,`summary`=''  WHERE  `id` = 233 [ RunTime:0.000842s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001785s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=13  WHERE  `groups` = 'Default' [ RunTime:0.000422s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001846s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=13  WHERE  `groups` = 'Default' [ RunTime:0.000912s ]
---------------------------------------------------------------
[ 2018-11-01T23:07:06+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/233.html
[ info ] qingrang.top/daily/admin/note/shownote/id/233.html [运行时间：0.055149s][吞吐率：18.13req/s] [内存消耗：1,990.15kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/233.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '233',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000590s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001471s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 233 LIMIT 1 [ RunTime:0.000508s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.001093s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000299s ]
---------------------------------------------------------------
[ 2018-11-01T23:07:47+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/editote/id/233.html
[ info ] qingrang.top/daily/admin/note/editote/id/233.html [运行时间：0.047126s][吞吐率：21.22req/s] [内存消耗：1,400.22kb] [文件加载：49]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'editote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '233',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ LOG ] INIT File
---------------------------------------------------------------
[ 2018-11-01T23:07:55+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/editnote/id/233.html
[ info ] qingrang.top/daily/admin/note/editnote/id/233.html [运行时间：0.064921s][吞吐率：15.40req/s] [内存消耗：2,053.75kb] [文件加载：56]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'editnote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '233',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->editNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/editnote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.001607s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.002871s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 233 LIMIT 1 [ RunTime:0.000767s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000907s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000345s ]
---------------------------------------------------------------
[ 2018-11-01T23:09:57+08:00 ] 74.120.168.12 74.120.168.12 POST /daily/admin/note/updatenote/id/233.html
[ info ] qingrang.top/daily/admin/note/updatenote/id/233.html [运行时间：0.086082s][吞吐率：11.62req/s] [内存消耗：2,129.27kb] [文件加载：58]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'updatenote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'content-length' => '30898',
  'cache-control' => 'max-age=0',
  'origin' => 'http://qingrang.top',
  'upgrade-insecure-requests' => '1',
  'content-type' => 'application/x-www-form-urlencoded',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/233.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'summary' => '',
  'content' => '# 中国史纲
[TOC]
## 中国历史的时空坐标
时间和空间加在一块,才是完整的历史。
### 四个时间坐标点
中国历史发生过几次重要的转型,这些转型推动着中国历史向前的发展。

1.第一个转型,是**商周之变**,就是从商朝到周朝的转型。

这次转型之后,我们开始有了“中国”这个概念,中华文明当中最初的普世主义理想开始出现了。

2.第二个转型,**周秦之变**,就是从周朝到秦朝的转型。

这次转型,让中原从分封割据的局面进入到大一统的局面,中国历史也开始超越于中原之上,中原与草原的相互塑造和对抗开始成为中国历史的大脉络。

3.第三个转型,**唐宋之变**,就是从唐朝到宋朝的转型。

这次转型,让中国的社会结构从豪族社会进入到平民社会,此后中国历史再无长期的分裂,大一统开始成为一个不可逆的历史过程。在先秦之后,中国的文化在宋朝迎来了又一次大爆发,有些西方学者甚至称这是中国的文艺复兴。这次文化爆发,不仅决定了此后将近一千年的中国文化气质,也决定了日本、朝鲜、越南等其他儒教国家的文化气质。

4.第四个转型,就是**清朝末期开始的古今之变**,中国开始从古代社会向现代社会进行艰难转型。

这个过程带来了一系列轰轰烈烈的历史过程,转型过程直到今天仍在继续,还未完成。

### 五个空间坐标点
草原、中原、海洋、西域、高原。

这几个大的空间,彼此之间有着极为深刻的相互依赖相互塑造的关系,以至于脱离开一方就完全解释不了另一方,所以它们加在一块构成一个体系。

## 中国的概念和中华文明的普世主义理想【商周】
### 历史上第一次出现「中国」
周朝的第二位君主周成王,兴建了东都洛阳城,当时有个叫做「何」的贵族,这人铸了一件青铜器纪念这个事儿,1963年这个青铜器在陕西宝鸡被发现,今天称其为「何尊」，「何尊」的底部铸了一百多个字,里面提到,周武王说要"宅兹中国”,就是说要“住在中国”,这是"中国"这个词的最早来源。

什么叫中国？**达到了文明最高水准的地方,就是文明意义上的中心,古人就管这种地方叫做「中国」。**
### 中华文明的普世主义理想：究竟天命是降于周人呢,还是天命降于周王
商朝是由“商人"。他们认为天命降于商人。为了让天能够永远地保佑自己,商人会经常地进行大规模的祭祀活动,祭祀当中会大量用到活人做祭品。

这些被献祭的人从哪来呢?

从对外战争掠夺的羌人而来。所谓的羌人就是生活在商王朝西部的、除了商朝人以外的所有人。

商人的这种天命观,肯定会受到羌人的抵抗。其中,周人是最主要的一支抵抗力量,他们逐渐组织了很多苦不堪言的羌人群体来反抗商朝，反抗的时候,在周人中间有过一个观念层面的争论,究竟天命是降于周人呢,还是天命降于周王?争论的结果是,天命降于周王。

这个观念变化太重要了。初看上去,这似乎是把天命的载体变得狭隘了,实际上是把它变得普世了。

为什么这么说呢?如果天命是降于周人,那就和此前降于商人的路数差不多,周人的岁月要想静好,就得时刻压制住所有不是周人的群体。这样的话,周人和商人征战,谁胜谁败就不好说了。因为,对其他羌人群体来说,打完这一仗,十有八九只不过换了个地方拿我们献祭,凭啥要跟你混啊?而**如果天命是降于周王,则周王便是天下的共主,他不仅仅要为周人主持正义,而是要为全天下人主持正义,这是一种真正的普世主义观念**。

### 什么是封建社会
推翻了商朝之后,周朝又是如何具体建立它的统治方式呢?那就是,分封制。周天子向下分封了他的大量亲戚和重臣,意图依靠他们形成的藩属诸侯国,来拱卫周王。这样一种政治统治形式就被称作“封建”,这种社会叫做封建社会。

封建“这个词最初出自《左传》,里面有句话叫做“封建亲戚,以藩屏周”,就是说分封亲信出去建立诸侯国,作为周朝王室领地的屏障。**只有这种封土建邦、分封割据的状态,才叫做封建。**

封建社会的一大特征是,最高统治者是没有权力干涉诸侯国内部事务的,诸侯们确实是最高统治者的封臣,但某种意义上也像是个合伙人,都有比较强的独立性。

周朝的时候,诸侯都承认周天子是最高权威,但周天子并不能管诸侯国内部的事情。周朝在这个过程中建立了封建社会,但周天子又逐渐衰落了。在周天子衰落之后,历史的主角就变成了那些诸侯。诸侯们彼此不断竞争,最终终结了中国的封建社会。

## 封建社会的终结【春秋末期、战国初期】
到了西周后期,周天子的影响力越来越差,最终被迫迁都洛阳,中国历史进入到东周。

东周又分成了舂秋战国两个时期,**春秋末期出现了一些重要的技术发展,它带来了新的经济和人力资源,打破了过去的社会均衡,封建社会当中的贵族秩序崩塌了，封建社会也在春秋战国时代走上末日。**

### 战争的逻辑的变化
春秋之前的的战争十分注重礼仪性(战争都是贵族在参与，这就导致了参与人数并不多，他们认为战争是一件高贵的事，他们的战争可能就是比谁的正步踢得好)。但到了春秋中后期,随着楚国(楚国是个土生政权,并不是周天子分封的诸侯国，它的文化和中原有很大区别,也不大在乎中原的礼仪之类的东西,在当时的中原诸侯看来它就是个蛮夷之邦。)的加入，战争变成以砍死人为目的了。也正是由于这个战争逻辑的变化,才把中国引向了大一统。

### 两个技术变迁
诸侯分封次级诸侯，随着次级诸侯势力的增大，诸侯和次级诸侯的关系同周天子和诸侯的关系一样。在春秋末期、战国初期,出现了两个重要的技术变迁,让诸侯力量的扩大有了可能。正是因为这两次技术变革,打破了君主和封臣之间的力量均衡,周厉王当初搞不定自己下级的事,现在诸侯可以做到了,也就是诸侯能够搞定这些次级诸侯。

这两个技术变迁,一个是铁器和牛耕的农业生产技术,一个是竹简这种知识传播技术。

>铁器和牛耕 - 农业生产技术

铁器与牛耕的出现,提升了平民的劳动效率。过去,他们的耕种效率很低,只能在贵族控制的公田、又叫井田上种地,没有能力再去开垦自己的私田了;但是,铁器和牛耕让生产效率大大提升了,平民有余力去开垦自己的私田,甚至索性就从贵族控制的井田上跑路了。此时君主、贵族、平民三者之间的一种复杂博弈关系就出现了。注意,这儿所说的君主,指的就是周天子封的诸侯,贵族指的就是诸侯所封的次级诸侯,这会儿的历史已经没周天子什么事儿了。

君主向耕种私田的平民提供保护,平民向君主交税。平民从井田上越跑越多,贵族所控制的井田制就逐渐瓦解了,贵族的力量也逐渐削弱了。君主开始获得相对于贵族的优势。

>竹简 - 知识传播技术

 知识传播的成本急剧下降,一般的贵族子弟、甚至运气好的普通百姓,都有机会学习文字获得知识了。由于多年的人口膨胀,这个时候出现了很多有文化、却无法获得一块封地的贵族子弟,他们就变成游士,到处寻找把自己卖个好价钱的机会。

君主们早就想养一群可控的自己人了。什么样的人最好用呢?

第一,他们要在本国没有根基,没资本对抗君主;
第二,他们的地位尊荣都取决于君主的赏赐,就有动力与君主相配合。

从别国跑来的游士完全符合这两点要求。君主与游士拍即合,游士成为依附于君主的私人人事班底。这个人事班底,后来就发展为官僚制。

官僚和贵族的区别在于,本质上来说,官僚没有独立性,他们是职业经理人,其地位取决于君主的意志;贵族有独立性,他们是准合伙人,君主有大事必须和他们商量着来。游士的出现,终于让君主们可以全方位碾压贵族封臣,诸侯国也就从君主与贵族共治的结构,转向君主说了算的官僚制结构。

### 变法

这个过程在历史上被叫作什么呢?

变法! 没错,魏国的李悝变法、秦国的商鞅变法等等,就是这样展开的。

来自其他国家的游士,成了各诸侯国的新贵,他们压制住所在国的大贵族,把君主的意志贯彻下去。随着各种变法的展开,中国历史就进入到了战国时代。

对君主来说,这回有办法把平民也动员起来了。你们虽然不是贵族血统,但你们可以立军功。只要你有办法从战场上拎回更多的人头,你也有机会上升到比贵族还高的地位。这种激励可不得了,战争的规模和频次急剧上升,大规模的灭国之战很容易就爆发了。灭国之战都到什么量级呢?比如很多人推崇的战神白起,一场战役就会坑杀赵国的40万降兵,这都在变法之后成为可能，变法这个事情也有传染性,谁最先变法,谁的战争效率就大幅上升;其他国家如果不跟上,就只能等着挨打。

**随着各国陆续变法,各诸侯国内部的旧贵族阶层被一扫而空**。变法之后,君主能决定军功的标准,也就能决定官僚新贵们的地位高低,**君主对国家的控制力就变得更强**,再没有能够约束君主的力量,**分封割据的封建社会也就逐渐走上了终结之日**,战争逻辑的变化,影响还不止于此,当战争规模扩大到了诸侯国承受不起的时候,中国也就开始走向大一统。

---
在春秋战国这样一个血光四射的年代,不仅有激烈的军事竞争,也发生了一系列激烈的思想竞争。这带来了中国历史上罕见的、大规模的思想变革,并在很大程度上奠定了之后两千多年中国人的精神基础。



',
  'groups' => 'Default',
  'showsel' => '1',
  'showse2' => '1',
  'id' => '233',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->updateNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ CACHE ] INIT File
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000956s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.002626s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 233 LIMIT 1 [ RunTime:0.000858s ]
[ sql ] [ SQL ] SELECT `groups` FROM `note` WHERE  `id` = 233 LIMIT 1 [ RunTime:0.000497s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.002285s ]
[ sql ] [ SQL ] SELECT `parent_id` FROM `groups` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.000550s ]
[ sql ] [ SQL ] SELECT `groups` FROM `groups` WHERE  `id` = 0 LIMIT 1 [ RunTime:0.000592s ]
[ sql ] [ SQL ] SELECT `id` FROM `groups` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.000425s ]
[ sql ] [ SQL ] UPDATE `note`  SET `id`=233,`p_id`=1,`title`='中国史纲\r',`content`='# 中国史纲\r\n[TOC]\r\n## 中国历史的时空坐标\r\n时间和空间加在一块,才是完整的历史。\r\n### 四个时间坐标点\r\n中国历史发生过几次重要的转型,这些转型推动着中国历史向前的发展。\r\n\r\n1.第一个转型,是**商周之变**,就是从商朝到周朝的转型。\r\n\r\n这次转型之后,我们开始有了“中国”这个概念,中华文明当中最初的普世主义理想开始出现了。\r\n\r\n2.第二个转型,**周秦之变**,就是从周朝到秦朝的转型。\r\n\r\n这次转型,让中原从分封割据的局面进入到大一统的局面,中国历史也开始超越于中原之上,中原与草原的相互塑造和对抗开始成为中国历史的大脉络。\r\n\r\n3.第三个转型,**唐宋之变**,就是从唐朝到宋朝的转型。\r\n\r\n这次转型,让中国的社会结构从豪族社会进入到平民社会,此后中国历史再无长期的分裂,大一统开始成为一个不可逆的历史过程。在先秦之后,中国的文化在宋朝迎来了又一次大爆发,有些西方学者甚至称这是中国的文艺复兴。这次文化爆发,不仅决定了此后将近一千年的中国文化气质,也决定了日本、朝鲜、越南等其他儒教国家的文化气质。\r\n\r\n4.第四个转型,就是**清朝末期开始的古今之变**,中国开始从古代社会向现代社会进行艰难转型。\r\n\r\n这个过程带来了一系列轰轰烈烈的历史过程,转型过程直到今天仍在继续,还未完成。\r\n\r\n### 五个空间坐标点\r\n草原、中原、海洋、西域、高原。\r\n\r\n这几个大的空间,彼此之间有着极为深刻的相互依赖相互塑造的关系,以至于脱离开一方就完全解释不了另一方,所以它们加在一块构成一个体系。\r\n\r\n## 中国的概念和中华文明的普世主义理想【商周】\r\n### 历史上第一次出现「中国」\r\n周朝的第二位君主周成王,兴建了东都洛阳城,当时有个叫做「何」的贵族,这人铸了一件青铜器纪念这个事儿,1963年这个青铜器在陕西宝鸡被发现,今天称其为「何尊」，「何尊」的底部铸了一百多个字,里面提到,周武王说要\"宅兹中国”,就是说要“住在中国”,这是\"中国\"这个词的最早来源。\r\n\r\n什么叫中国？**达到了文明最高水准的地方,就是文明意义上的中心,古人就管这种地方叫做「中国」。**\r\n### 中华文明的普世主义理想：究竟天命是降于周人呢,还是天命降于周王\r\n商朝是由“商人\"。他们认为天命降于商人。为了让天能够永远地保佑自己,商人会经常地进行大规模的祭祀活动,祭祀当中会大量用到活人做祭品。\r\n\r\n这些被献祭的人从哪来呢?\r\n\r\n从对外战争掠夺的羌人而来。所谓的羌人就是生活在商王朝西部的、除了商朝人以外的所有人。\r\n\r\n商人的这种天命观,肯定会受到羌人的抵抗。其中,周人是最主要的一支抵抗力量,他们逐渐组织了很多苦不堪言的羌人群体来反抗商朝，反抗的时候,在周人中间有过一个观念层面的争论,究竟天命是降于周人呢,还是天命降于周王?争论的结果是,天命降于周王。\r\n\r\n这个观念变化太重要了。初看上去,这似乎是把天命的载体变得狭隘了,实际上是把它变得普世了。\r\n\r\n为什么这么说呢?如果天命是降于周人,那就和此前降于商人的路数差不多,周人的岁月要想静好,就得时刻压制住所有不是周人的群体。这样的话,周人和商人征战,谁胜谁败就不好说了。因为,对其他羌人群体来说,打完这一仗,十有八九只不过换了个地方拿我们献祭,凭啥要跟你混啊?而**如果天命是降于周王,则周王便是天下的共主,他不仅仅要为周人主持正义,而是要为全天下人主持正义,这是一种真正的普世主义观念**。\r\n\r\n### 什么是封建社会\r\n推翻了商朝之后,周朝又是如何具体建立它的统治方式呢?那就是,分封制。周天子向下分封了他的大量亲戚和重臣,意图依靠他们形成的藩属诸侯国,来拱卫周王。这样一种政治统治形式就被称作“封建”,这种社会叫做封建社会。\r\n\r\n封建“这个词最初出自《左传》,里面有句话叫做“封建亲戚,以藩屏周”,就是说分封亲信出去建立诸侯国,作为周朝王室领地的屏障。**只有这种封土建邦、分封割据的状态,才叫做封建。**\r\n\r\n封建社会的一大特征是,最高统治者是没有权力干涉诸侯国内部事务的,诸侯们确实是最高统治者的封臣,但某种意义上也像是个合伙人,都有比较强的独立性。\r\n\r\n周朝的时候,诸侯都承认周天子是最高权威,但周天子并不能管诸侯国内部的事情。周朝在这个过程中建立了封建社会,但周天子又逐渐衰落了。在周天子衰落之后,历史的主角就变成了那些诸侯。诸侯们彼此不断竞争,最终终结了中国的封建社会。\r\n\r\n## 封建社会的终结【春秋末期、战国初期】\r\n到了西周后期,周天子的影响力越来越差,最终被迫迁都洛阳,中国历史进入到东周。\r\n\r\n东周又分成了舂秋战国两个时期,**春秋末期出现了一些重要的技术发展,它带来了新的经济和人力资源,打破了过去的社会均衡,封建社会当中的贵族秩序崩塌了，封建社会也在春秋战国时代走上末日。**\r\n\r\n### 战争的逻辑的变化\r\n春秋之前的的战争十分注重礼仪性(战争都是贵族在参与，这就导致了参与人数并不多，他们认为战争是一件高贵的事，他们的战争可能就是比谁的正步踢得好)。但到了春秋中后期,随着楚国(楚国是个土生政权,并不是周天子分封的诸侯国，它的文化和中原有很大区别,也不大在乎中原的礼仪之类的东西,在当时的中原诸侯看来它就是个蛮夷之邦。)的加入，战争变成以砍死人为目的了。也正是由于这个战争逻辑的变化,才把中国引向了大一统。\r\n\r\n### 两个技术变迁\r\n诸侯分封次级诸侯，随着次级诸侯势力的增大，诸侯和次级诸侯的关系同周天子和诸侯的关系一样。在春秋末期、战国初期,出现了两个重要的技术变迁,让诸侯力量的扩大有了可能。正是因为这两次技术变革,打破了君主和封臣之间的力量均衡,周厉王当初搞不定自己下级的事,现在诸侯可以做到了,也就是诸侯能够搞定这些次级诸侯。\r\n\r\n这两个技术变迁,一个是铁器和牛耕的农业生产技术,一个是竹简这种知识传播技术。\r\n\r\n>铁器和牛耕 - 农业生产技术\r\n\r\n铁器与牛耕的出现,提升了平民的劳动效率。过去,他们的耕种效率很低,只能在贵族控制的公田、又叫井田上种地,没有能力再去开垦自己的私田了;但是,铁器和牛耕让生产效率大大提升了,平民有余力去开垦自己的私田,甚至索性就从贵族控制的井田上跑路了。此时君主、贵族、平民三者之间的一种复杂博弈关系就出现了。注意,这儿所说的君主,指的就是周天子封的诸侯,贵族指的就是诸侯所封的次级诸侯,这会儿的历史已经没周天子什么事儿了。\r\n\r\n君主向耕种私田的平民提供保护,平民向君主交税。平民从井田上越跑越多,贵族所控制的井田制就逐渐瓦解了,贵族的力量也逐渐削弱了。君主开始获得相对于贵族的优势。\r\n\r\n>竹简 - 知识传播技术\r\n\r\n 知识传播的成本急剧下降,一般的贵族子弟、甚至运气好的普通百姓,都有机会学习文字获得知识了。由于多年的人口膨胀,这个时候出现了很多有文化、却无法获得一块封地的贵族子弟,他们就变成游士,到处寻找把自己卖个好价钱的机会。\r\n\r\n君主们早就想养一群可控的自己人了。什么样的人最好用呢?\r\n\r\n第一,他们要在本国没有根基,没资本对抗君主;\r\n第二,他们的地位尊荣都取决于君主的赏赐,就有动力与君主相配合。\r\n\r\n从别国跑来的游士完全符合这两点要求。君主与游士拍即合,游士成为依附于君主的私人人事班底。这个人事班底,后来就发展为官僚制。\r\n\r\n官僚和贵族的区别在于,本质上来说,官僚没有独立性,他们是职业经理人,其地位取决于君主的意志;贵族有独立性,他们是准合伙人,君主有大事必须和他们商量着来。游士的出现,终于让君主们可以全方位碾压贵族封臣,诸侯国也就从君主与贵族共治的结构,转向君主说了算的官僚制结构。\r\n\r\n### 变法\r\n\r\n这个过程在历史上被叫作什么呢?\r\n\r\n变法! 没错,魏国的李悝变法、秦国的商鞅变法等等,就是这样展开的。\r\n\r\n来自其他国家的游士,成了各诸侯国的新贵,他们压制住所在国的大贵族,把君主的意志贯彻下去。随着各种变法的展开,中国历史就进入到了战国时代。\r\n\r\n对君主来说,这回有办法把平民也动员起来了。你们虽然不是贵族血统,但你们可以立军功。只要你有办法从战场上拎回更多的人头,你也有机会上升到比贵族还高的地位。这种激励可不得了,战争的规模和频次急剧上升,大规模的灭国之战很容易就爆发了。灭国之战都到什么量级呢?比如很多人推崇的战神白起,一场战役就会坑杀赵国的40万降兵,这都在变法之后成为可能，变法这个事情也有传染性,谁最先变法,谁的战争效率就大幅上升;其他国家如果不跟上,就只能等着挨打。\r\n\r\n**随着各国陆续变法,各诸侯国内部的旧贵族阶层被一扫而空**。变法之后,君主能决定军功的标准,也就能决定官僚新贵们的地位高低,**君主对国家的控制力就变得更强**,再没有能够约束君主的力量,**分封割据的封建社会也就逐渐走上了终结之日**,战争逻辑的变化,影响还不止于此,当战争规模扩大到了诸侯国承受不起的时候,中国也就开始走向大一统。\r\n\r\n---\r\n在春秋战国这样一个血光四射的年代,不仅有激烈的军事竞争,也发生了一系列激烈的思想竞争。这带来了中国历史上罕见的、大规模的思想变革,并在很大程度上奠定了之后两千多年中国人的精神基础。\r\n\r\n\r\n\r\n',`groups`='Default',`is_show`=1,`publish`=1,`summary`=''  WHERE  `id` = 233 [ RunTime:0.001394s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.002175s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=13  WHERE  `groups` = 'Default' [ RunTime:0.000377s ]
[ sql ] [ SQL ] SELECT COUNT(*) AS tp_count FROM `note` WHERE  `groups` = 'Default' LIMIT 1 [ RunTime:0.001021s ]
[ sql ] [ SQL ] UPDATE `groups`  SET `g_count`=13  WHERE  `groups` = 'Default' [ RunTime:0.000335s ]
---------------------------------------------------------------
[ 2018-11-01T23:09:58+08:00 ] 74.120.168.12 74.120.168.12 GET /daily/admin/note/shownote/id/233.html
[ info ] qingrang.top/daily/admin/note/shownote/id/233.html [运行时间：0.062986s][吞吐率：15.88req/s] [内存消耗：1,990.17kb] [文件加载：55]
[ info ] [ LANG ] /var/www/html/daily/thinkphp/lang/zh-cn.php
[ info ] [ ROUTE ] array (
  'type' => 'module',
  'module' => 
  array (
    0 => 'admin',
    1 => 'note',
    2 => 'shownote',
  ),
)
[ info ] [ HEADER ] array (
  'host' => 'qingrang.top',
  'cache-control' => 'max-age=0',
  'upgrade-insecure-requests' => '1',
  'user-agent' => 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36',
  'accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8',
  'referer' => 'http://qingrang.top/daily/admin/note/editnote/id/233.html',
  'accept-encoding' => 'gzip, deflate',
  'accept-language' => 'zh-CN,zh;q=0.9,la;q=0.8,en;q=0.7,lb;q=0.6',
  'cookie' => 'Hm_lvt_1769181352e9adc950166aada465644e=1540387796,1540648649,1540982738,1541082864; Hm_lpvt_1769181352e9adc950166aada465644e=1541082864; PHPSESSID=7tol2lrlojb7s86niijqek14a4',
  'connection' => 'close',
)
[ info ] [ PARAM ] array (
  'id' => '233',
)
[ info ] [ SESSION ] INIT array (
  'id' => '',
  'var_session_id' => '',
  'prefix' => 'think',
  'type' => '',
  'auto_start' => true,
)
[ info ] [ RUN ] app\admin\controller\Note->showNote[ /var/www/html/daily/application/admin/controller/Note.php ]
[ info ] [ DB ] INIT mysql
[ info ] [ VIEW ] /var/www/html/daily/application/admin/view/note/shownote.html [ array (
  0 => 'note',
  1 => 'groups',
) ]
[ info ] [ LOG ] INIT File
[ sql ] [ DB ] CONNECT:[ UseTime:0.000640s ] mysql:host=74.120.168.12;dbname=diary;charset=utf8
[ sql ] [ SQL ] SHOW COLUMNS FROM `note` [ RunTime:0.001825s ]
[ sql ] [ SQL ] SELECT * FROM `note` WHERE  `id` = 233 LIMIT 1 [ RunTime:0.000593s ]
[ sql ] [ SQL ] SHOW COLUMNS FROM `groups` [ RunTime:0.000894s ]
[ sql ] [ SQL ] SELECT * FROM `groups` [ RunTime:0.000361s ]
